import{z as Ee,E as ze,j as e,r as i,b as Ne,M as De,B as M,G as j,F as k,f as _e,k as H,p as Ae,m as Ve,d as Pe,q as Ie,i as p,T as v,A as Re,e as E}from"./index-lZI9Axgt.js";import{u as z,w as Fe}from"./xlsx-ChUIJHMt.js";import{g as u,p as ne}from"./request-ClRr-5Ll.js";import{d as $e}from"./Add-BJ73JR4M.js";import{d as We,I as Ke}from"./InsertDriveFile-lwaIMdYU.js";import{M as N}from"./MenuItem-Divc6vnu.js";import{R as Be,a as Le}from"./RadioGroup-Dd5T_W4C.js";import{F as Me}from"./FormControlLabel-BBO_n_LH.js";import{F as G}from"./Fab-CuekNszq.js";import{T as He,a as Ge,b as Oe,c as O,d as Ye}from"./TableRow-D7eToa8r.js";import{T as r}from"./TableCell-jiXaIEqu.js";import{S as Xe}from"./Switch-CvCt3I2e.js";import{T as qe}from"./TablePagination-CE4OcBPd.js";import{D as Y,a as X,b as q,c as J}from"./DialogTitle-Bl5CTXqr.js";import{S as Je}from"./Snackbar-DKwmTxl_.js";import"./SwitchBase-I1IR-Hvy.js";import"./KeyboardArrowRight-N4GCKU9q.js";import"./LastPage-CPU0u6Bk.js";var D={},Qe=ze;Object.defineProperty(D,"__esModule",{value:!0});var te=D.default=void 0,Ue=Qe(Ee()),Ze=e;te=D.default=(0,Ue.default)((0,Ze.jsx)("path",{d:"M21 10h-8.35C11.83 7.67 9.61 6 7 6c-3.31 0-6 2.69-6 6s2.69 6 6 6c2.61 0 4.83-1.67 5.65-4H13l2 2 2-2 2 2 4-4.04zM7 15c-1.65 0-3-1.35-3-3s1.35-3 3-3 3 1.35 3 3-1.35 3-3 3"}),"Key");const Q=async s=>{try{return await u(`/nhan_vien/all?pageNo=${s}`)}catch(a){throw console.error("Error fetching Employees:",a),a}},en=async()=>{try{return await u("/nhan_vien/danhsachnhanvien")}catch(s){throw console.error("Error fetching Employees:",s),s}},U=async(s,a,c)=>{try{return await u(`/nhan_vien/search?pageNo=${s}&search=${c}`)}catch(l){throw console.error("Error fetching Employees by keyword:",l),l}},Z=async(s,a,c)=>{try{debugger;return await u(`/nhan_vien/searchtrangthai?pageNo=${s}&trangThai=${c}`)}catch(l){throw console.error("Error fetching Employees by status:",l),l}},ee=async(s,a,c)=>{try{debugger;return await u(`/nhan_vien/searchgioitinh?pageNo=${s}&gioiTinh=${c}`)}catch(l){throw console.error("Error fetching Employees by sex:",l),l}},nn=async s=>{try{return await ne(`/nhan_vien/remove/${s}`)}catch(a){throw console.error("Error deleting Employee:",a),a}},tn=async s=>{try{return await ne(`/nhan_vien/rollBackStatus/${s}`)}catch(a){throw console.error("Error rolling back Employee status:",a),a}},an=async s=>{try{debugger;const a=await u(`/nhan_vien/sendemailforgotpassword/${s}`)}catch(a){throw console.log("Error sent email password"),a}},kn=()=>{const[s,a]=i.useState(1);i.useState(0);const[c,l]=i.useState(""),[d,y]=i.useState(""),[ae,b]=i.useState(!1),[_,A]=i.useState(null),[S,V]=i.useState(null),[P,re]=i.useState([]),[rn,se]=i.useState([]),[x,w]=i.useState(""),[sn,I]=i.useState(!1);i.useState("");const[ie,C]=i.useState(!1),[m,f]=i.useState({open:!1,message:"",severity:"success"}),[T,oe]=i.useState(null),le=[{id:"",name:"Tất Cả"},{id:"0",name:"Đã Nghỉ Việc"},{id:"1",name:"Đang Làm Việc"}],R=Ne(),[t,F]=i.useState({page:0,size:5}),[ce,he]=i.useState(0),$=async()=>{try{debugger;let n;c?n=await U(t.page,t.size,c):d?n=await Z(t.page,t.size,d):x!==""?n=await ee(t.page,t.size,x):n=await Q(t.page,t.size),re(n.content),he(n.totalElements)}catch(n){console.log(n)}},de=(n,o)=>{F(g=>({...g,page:o}))},xe=n=>{F({...t,size:parseInt(n.target.value,10),page:0})},ge=async()=>{let n;try{n=await en(),se(n)}catch(o){console.log(o)}};i.useEffect(()=>{$()},[t.page,t.size,c,d,x]),i.useEffect(()=>{ge()},[]);const pe=n=>{switch(n){case 0:return e.jsx(E,{label:"Đã Nghỉ Việc",color:"default",style:{backgroundColor:"#f44336",color:"#fff"}});case 1:return e.jsx(E,{label:"Đang Làm Việc",color:"success",style:{backgroundColor:"#4caf50",color:"#fff"}});default:return e.jsx(E,{label:"Không xác định",color:"warning",style:{backgroundColor:"#ff9800",color:"#fff"}})}},ue=n=>{l(n.target.value),a(1),y(""),w("")},me=n=>{debugger;y(n.target.value),a(1),l(""),w("")},fe=n=>{const o=n.target.value;w(o),a(1),l(""),y("")},je=async()=>{b(!1);try{S===0?await nn(_):await tn(_),$()}catch(n){console.error("Error updating employee status:",n)}},W=()=>{b(!1),A(null),V(null)},K=n=>{const o={year:"numeric",month:"2-digit",day:"2-digit"};return new Date(n).toLocaleDateString("vi-VN",o)},ye=(n,o)=>{A(n),V(o===1?0:1),b(!0)},be=()=>{R("/nhanvien/configuration")},Se=n=>{R(`/nhanvien/configuration/${n}`)},we=new Date().getFullYear();Array.from(new Array(101),(n,o)=>we-o);const Ce=async()=>{try{let n;c?n=await U(t.page,t.size,c):d?n=await Z(t.page,t.size,d):x!==""?n=await ee(t.page,t.size,x):n=await Q(t.page,t.size);const o=z.json_to_sheet(n.content.map((h,ve)=>({STT:ve+1+(t.page-1)*t.size,"Hình Ảnh":h.hinhAnh,Mã:h.ma,Tên:h.ten,"Ngày Sinh":K(h.ngaySinh),"Số Điện Thoại":h.sdt,Email:h.email,"Địa Chỉ":h.diaChi,"Trạng Thái":h.trangThai===1?"Đang Làm Việc":"Đã Nghỉ Việc"}))),g=z.book_new();z.book_append_sheet(g,o,"Danh Sách Nhân Viên"),Fe(g,"danh_sach_nhan_vien.xlsx")}catch(n){console.log("Lỗi khi xuất file Excel:",n)}},Te=n=>{C(!0),oe(n)},B=()=>{C(!1)},ke=async n=>{if(!n){f({open:!0,message:"Email không hợp lệ.",severity:"error"});return}I(!0);try{await an(n),f({open:!0,message:"Email reset mật khẩu đã được gửi!",severity:"success"})}catch{f({open:!0,message:"Có lỗi xảy ra khi gửi email.",severity:"error"})}finally{I(!1),C(!1)}},L=()=>{f({...m,open:!1})};return e.jsxs(De,{style:{textAlign:"center"},children:[e.jsxs(M,{sx:{backgroundColor:"white",boxShadow:"0 4px 8px rgba(0.3, 0.3, 0.2, 0.3)",borderRadius:"8px",p:3,mb:3,width:"100%"},children:[e.jsxs(j,{container:!0,spacing:3,children:[e.jsxs(j,{item:!0,xs:12,sm:6,md:4,children:[e.jsx(k,{component:"legend",sx:{fontWeight:"bold",mb:1},children:"Tìm Kiếm"}),e.jsx(_e,{label:"Tìm kiếm theo mã, tên, email, số điện thoại",value:c,onChange:ue,variant:"outlined",fullWidth:!0})]}),e.jsxs(j,{item:!0,xs:12,sm:6,md:4,children:[e.jsx(k,{component:"legend",sx:{fontWeight:"bold",mb:1},children:"Giới Tính"}),e.jsxs(H,{fullWidth:!0,children:[e.jsx(Ae,{id:"gender-select-label",children:"-- Chọn giới tính --"}),e.jsxs(Ve,{labelId:"gender-select-label",id:"gender-select",value:x,onChange:fe,children:[e.jsx(N,{value:"",children:e.jsx("em",{children:"-- Chọn giới tính --"})}),e.jsx(N,{value:1,children:"Nam"}),e.jsx(N,{value:0,children:"Nữ"})]})]})]}),e.jsxs(j,{item:!0,xs:12,sm:12,md:4,children:[e.jsx(k,{component:"legend",sx:{fontWeight:"bold",mb:1},children:"Trạng Thái"}),e.jsx(H,{component:"fieldset",fullWidth:!0,children:e.jsx(Be,{row:!0,value:d,onChange:me,children:le.map(n=>e.jsx(Me,{value:n.id,control:e.jsx(Le,{}),label:n.name},n.id))})})]})]}),e.jsxs(M,{sx:{position:"fixed",top:350,right:16,display:"flex",flexDirection:"column",alignItems:"center",zIndex:1300},children:[e.jsx(G,{color:"primary","aria-label":"add",title:"Thêm Nhân Viên",sx:{height:"60px",width:"60px",backgroundColor:"#007bff",color:"#fff",boxShadow:"0px 8px 15px rgba(0, 123, 255, 0.3)",transition:"all 0.3s ease",marginBottom:"10px","&:hover":{backgroundColor:"#0056b3",boxShadow:"0px 15px 20px rgba(0, 86, 179, 0.4)",transform:"translateY(-3px)"},"&:active":{backgroundColor:"#004080",boxShadow:"0px 5px 10px rgba(0, 64, 128, 0.2)",transform:"translateY(1px)"}},onClick:be,children:e.jsx($e,{sx:{fontSize:"30px"}})}),e.jsx(G,{color:"primary","aria-label":"export",title:"Xuất danh sách nhân viên",sx:{height:"60px",width:"60px",backgroundColor:"#28a745",color:"#fff",boxShadow:"0px 8px 15px rgba(40, 167, 69, 0.3)",transition:"all 0.3s ease","&:hover":{backgroundColor:"#218838",boxShadow:"0px 15px 20px rgba(33, 136, 56, 0.4)",transform:"translateY(-3px)"},"&:active":{backgroundColor:"#1e7e34",boxShadow:"0px 5px 10px rgba(30, 126, 52, 0.2)",transform:"translateY(1px)"}},onClick:Ce,children:e.jsx(We,{sx:{fontSize:"30px"}})})]})]}),e.jsx(He,{component:Pe,children:e.jsxs(Ge,{children:[e.jsx(Oe,{children:e.jsxs(O,{children:[e.jsx(r,{sx:{fontSize:"12px",padding:"8px",textAlign:"center"},children:"STT"}),e.jsx(r,{sx:{fontSize:"12px",padding:"8px",textAlign:"center"},children:"Mã"}),e.jsx(r,{sx:{fontSize:"12px",padding:"8px",textAlign:"center"},children:"Tên"}),e.jsx(r,{sx:{fontSize:"12px",padding:"8px",textAlign:"center"},children:"Ngày Sinh"}),e.jsx(r,{sx:{fontSize:"12px",padding:"8px",textAlign:"center"},children:"SĐT"}),e.jsx(r,{sx:{fontSize:"12px",padding:"8px",textAlign:"center"},children:"Email"}),e.jsx(r,{sx:{fontSize:"12px",padding:"8px",textAlign:"center"},children:"Hình Ảnh"}),e.jsx(r,{sx:{fontSize:"12px",padding:"8px",textAlign:"center"},children:"Địa Chỉ"}),e.jsx(r,{sx:{fontSize:"12px",padding:"8px",textAlign:"center"},children:"Trạng Thái"}),e.jsx(r,{sx:{fontSize:"12px",padding:"8px",textAlign:"center"},children:"Hành Động"})]})}),e.jsx(Ye,{children:P.length>0&&P.map((n,o)=>{const g=K(n.ngaySinh);return e.jsxs(O,{children:[e.jsx(r,{children:o+1+(s-1)*5}),e.jsx(r,{children:e.jsx(Ie,{alt:n.ten,src:n.hinhAnh,sx:{width:100,height:100}})}),e.jsx(r,{children:n.ma}),e.jsx(r,{children:n.ten}),e.jsx(r,{children:g}),e.jsx(r,{children:n.sdt}),e.jsx(r,{children:n.email}),e.jsx(r,{children:n.diaChi}),e.jsx(r,{children:pe(n.trangThai)}),e.jsxs(r,{sx:{fontSize:"12px",padding:"8px",textAlign:"center"},children:[e.jsx(p,{className:"btn btn-link",title:"Sửa Nhân Viên",children:e.jsx(Ke,{stroke:2,onClick:()=>Se(n.id)})}),e.jsx(Xe,{checked:n.trangThai===1,onChange:()=>ye(n.id,n.trangThai),color:"primary",title:"Trạng thái nhân viên"}),e.jsx(p,{title:"Cấp lại mật khẩu cho nhân viên",onClick:()=>Te(n.email),variant:"text",sx:{minWidth:0,padding:0},children:e.jsx(te,{sx:{fontSize:30,color:"green"}})})]})]},n.id)})})]})}),e.jsx(qe,{rowsPerPageOptions:[5],component:"div",count:ce,rowsPerPage:t.size,page:t.page,onPageChange:de,onRowsPerPageChange:xe}),e.jsxs(Y,{open:ae,onClose:W,"aria-labelledby":"alert-dialog-title","aria-describedby":"alert-dialog-description",children:[e.jsx(X,{id:"alert-dialog-title",children:"Xác nhận thay đổi trạng thái"}),e.jsx(q,{children:e.jsxs(v,{children:["Bạn có chắc chắn muốn ",S===0?"xóa":"khôi phục"," nhân viên này không?"]})}),e.jsxs(J,{children:[e.jsx(p,{onClick:W,color:"primary",children:"Hủy"}),e.jsx(p,{onClick:je,color:"secondary",autoFocus:!0,children:S===0?"Xóa":"Khôi phục"})]})]}),e.jsxs(Y,{open:ie,onClose:B,children:[e.jsx(X,{children:"Xác nhận cấp lại mật khẩu"}),e.jsx(q,{children:T?e.jsxs(v,{children:["Bạn có chắc chắn muốn cấp lại mật khẩu cho nhân viên ",e.jsx("strong",{children:T})," không?"]}):e.jsx(v,{color:"error",children:"Không thể lấy thông tin email của nhân viên. Vui lòng kiểm tra lại dữ liệu."})}),e.jsxs(J,{children:[e.jsx(p,{onClick:B,children:"Hủy"}),e.jsx(p,{onClick:()=>ke(T),children:"Xác nhận"})]})]}),e.jsx(Je,{open:m.open,autoHideDuration:6e3,onClose:L,anchorOrigin:{vertical:"top",horizontal:"right"},children:e.jsx(Re,{onClose:L,severity:m.severity,sx:{width:"100%"},children:m.message})})]})};export{kn as default};

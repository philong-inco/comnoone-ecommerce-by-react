import{y as en,aA as nn,r as i,j as e,a as ue,G as g,T as f,aV as tn,E as we,m as O,d as Oe,e as ee,f as Z,n as ye,t as ve,o as Ne,b as an,p as sn}from"./index-DkjfH3Nj.js";import{d as rn}from"./ArrowBack-UBXgL3WF.js";import{u as on,d as Le,f as ln,h as cn}from"./billService-LSyzHNP3.js";import{b as Ae,c as hn,g as dn,a as un}from"./billStatus-C6FG20SU.js";import{D as xe,a as me,b as de,c as gn}from"./DialogTitle-AfTjaLGA.js";import{T as Pe,a as _e,b as Fe,c as pe,d as Be}from"./TableRow-DrBFg2V4.js";import{T as S}from"./TableCell-BUbxn9S2.js";import{D as ke}from"./DialogContentText-C61vxrGH.js";import{S as ge,A as fe}from"./Snackbar-BAUbN_1o.js";import{f as Ee,b as je,c as Ce,e as Ge,h as Re,g as xn,C as mn,S as pn}from"./CouponDiaLog-CvRyRpZu.js";import{B as se}from"./ImportProduct-DAjh42MA.js";import"./request-DcjhHzTt.js";import{M as ie}from"./MenuItem-B1FZ8Sxq.js";import"./Close-DQEw0W5Z.js";import"./Checkbox-CJjLKa6W.js";import"./Pagination-BgvdVt-w.js";import"./LastPage-CMxtDi2C.js";import"./index-DPnwyd78.js";import"./couponsService-D4rGWuAg.js";import"./xlsx-ChUIJHMt.js";import"./sanPham-CVbMZL9v.js";import"./back-end-vuWvP0DO.js";var Y=en("article-filled-filled","IconArticleFilledFilled",[["path",{d:"M19 3a3 3 0 0 1 2.995 2.824l.005 .176v12a3 3 0 0 1 -2.824 2.995l-.176 .005h-14a3 3 0 0 1 -2.995 -2.824l-.005 -.176v-12a3 3 0 0 1 2.824 -2.995l.176 -.005h14zm-2 12h-10l-.117 .007a1 1 0 0 0 0 1.986l.117 .007h10l.117 -.007a1 1 0 0 0 0 -1.986l-.117 -.007zm0 -4h-10l-.117 .007a1 1 0 0 0 0 1.986l.117 .007h10l.117 -.007a1 1 0 0 0 0 -1.986l-.117 -.007zm0 -4h-10l-.117 .007a1 1 0 0 0 0 1.986l.117 .007h10l.117 -.007a1 1 0 0 0 0 -1.986l-.117 -.007z",fill:"currentColor",key:"svg-0",strokeWidth:"0"}]]),Me={exports:{}};/*!
	Copyright (c) 2018 Jed Watson.
	Licensed under the MIT License (MIT), see
	http://jedwatson.github.io/classnames
*/(function(u){(function(){var s={}.hasOwnProperty;function t(){for(var h="",j=0;j<arguments.length;j++){var C=arguments[j];C&&(h=x(h,m(C)))}return h}function m(h){if(typeof h=="string"||typeof h=="number")return h;if(typeof h!="object")return"";if(Array.isArray(h))return t.apply(null,h);if(h.toString!==Object.prototype.toString&&!h.toString.toString().includes("[native code]"))return h.toString();var j="";for(var C in h)s.call(h,C)&&h[C]&&(j=x(j,C));return j}function x(h,j){return j?h?h+" "+j:h+j:h}u.exports?(t.default=t,u.exports=t):window.classNames=t})()})(Me);var jn=Me.exports;const B=nn(jn),Cn=["xxl","xl","lg","md","sm","xs"],fn="xs",yn=i.createContext({prefixes:{},breakpoints:Cn,minBreakpoint:fn});function R(u,s){const{prefixes:t}=i.useContext(yn);return u||t[s]||s}const Ke=u=>i.forwardRef((s,t)=>e.jsx("div",{...s,ref:t,className:B(s.className,u)})),Se=i.forwardRef(({className:u,bsPrefix:s,as:t="div",...m},x)=>(s=R(s,"card-body"),e.jsx(t,{ref:x,className:B(u,s),...m})));Se.displayName="CardBody";const Ve=i.forwardRef(({className:u,bsPrefix:s,as:t="div",...m},x)=>(s=R(s,"card-footer"),e.jsx(t,{ref:x,className:B(u,s),...m})));Ve.displayName="CardFooter";const Xe=i.createContext(null);Xe.displayName="CardHeaderContext";const Ue=i.forwardRef(({bsPrefix:u,className:s,as:t="div",...m},x)=>{const h=R(u,"card-header"),j=i.useMemo(()=>({cardHeaderBsPrefix:h}),[h]);return e.jsx(Xe.Provider,{value:j,children:e.jsx(t,{ref:x,...m,className:B(s,h)})})});Ue.displayName="CardHeader";const ze=i.forwardRef(({bsPrefix:u,className:s,variant:t,as:m="img",...x},h)=>{const j=R(u,"card-img");return e.jsx(m,{ref:h,className:B(t?`${j}-${t}`:j,s),...x})});ze.displayName="CardImg";const Ye=i.forwardRef(({className:u,bsPrefix:s,as:t="div",...m},x)=>(s=R(s,"card-img-overlay"),e.jsx(t,{ref:x,className:B(u,s),...m})));Ye.displayName="CardImgOverlay";const $e=i.forwardRef(({className:u,bsPrefix:s,as:t="a",...m},x)=>(s=R(s,"card-link"),e.jsx(t,{ref:x,className:B(u,s),...m})));$e.displayName="CardLink";const vn=Ke("h6"),Qe=i.forwardRef(({className:u,bsPrefix:s,as:t=vn,...m},x)=>(s=R(s,"card-subtitle"),e.jsx(t,{ref:x,className:B(u,s),...m})));Qe.displayName="CardSubtitle";const qe=i.forwardRef(({className:u,bsPrefix:s,as:t="p",...m},x)=>(s=R(s,"card-text"),e.jsx(t,{ref:x,className:B(u,s),...m})));qe.displayName="CardText";const Nn=Ke("h5"),Je=i.forwardRef(({className:u,bsPrefix:s,as:t=Nn,...m},x)=>(s=R(s,"card-title"),e.jsx(t,{ref:x,className:B(u,s),...m})));Je.displayName="CardTitle";const Ze=i.forwardRef(({bsPrefix:u,className:s,bg:t,text:m,border:x,body:h=!1,children:j,as:C="div",...y},b)=>{const H=R(u,"card");return e.jsx(C,{ref:b,...y,className:B(s,H,t&&`bg-${t}`,m&&`text-${m}`,x&&`border-${x}`),children:h?e.jsx(Se,{children:j}):j})});Ze.displayName="Card";const Sn=Object.assign(Ze,{Img:ze,Title:Je,Subtitle:Qe,Body:Se,Link:$e,Text:qe,Header:Ue,Footer:Ve,ImgOverlay:Ye});function bn(u){const{id:s}=ue(),{data:t,onLoading:m,bill:x}=u;i.useState(!1);const h=window.innerHeight*.5,j=r=>r===0?e.jsx(Y,{style:{color:"#3f51b5",width:"100%",transform:"scale(2)"}}):r===1?e.jsx(Y,{style:{color:"#f44336",width:"100%",transform:"scale(2)"}}):r==="VAN_CHUYEN"?e.jsx(Y,{style:{color:"#ff9800",width:"100%",transform:"scale(2)"}}):r==="CHO_VAN_CHUYEN"?e.jsx(Y,{style:{color:"#2196f3",width:"100%",transform:"scale(2)"}}):r==="DA_THANH_TOAN"?e.jsx(Y,{style:{color:"#4caf50",width:"100%",transform:"scale(2)"}}):r==="THANH_CONG"?e.jsx(Y,{style:{color:"#8bc34a",width:"100%",transform:"scale(2)"}}):r===8?e.jsx(Y,{style:{color:"#f44336",width:"100%",transform:"scale(2)"}}):e.jsx(Y,{style:{color:"#9e9e9e",width:"100%",transform:"scale(2)"}}),C=r=>{let o="Trạng thái chưa được định nghĩa",n="default";switch(r){case"DON_MOI":o="ĐƠN MỚI",n="primary";break;case"HUY":o="HỦY",n="error";break;case"CHO_GIAO":o="CHỜ VẬN CHUYỂN",n="warning";break;case"DANG_GIAO":o="ĐÃ VẬN CHUYỂN",n="info";break;case"TRA_HANG_HOAN_TIEN":o="TRẢ HÀNG HOÀN TIỀN",n="success";break;case"HOAN_THANH":o="HOÀN THÀNH",n="success";break;case"XAC_NHAN":o="ĐÃ XÁC NHẬN",n="primary";break;case"CHO_XAC_NHAN":o="CHỜ XÁC NHẬN",n="warning";break}return e.jsx(ee,{label:o,color:n})},y=[{id:"stt",label:"STT"},{id:"ngayTao",label:"Thời gian",minWidth:100,maxWidth:250},{id:"nguoiSua",label:"Người chỉnh sửa",minWidth:100,maxWidth:150},{id:"ghiChuChoCuaHang",label:"Ghi chú của hàng",minWidth:150,maxWidth:200},{id:"ghiChuChoKhachHang",label:"Ghi chú khách hàng",minWidth:150,maxWidth:200},{id:"trangThai",label:"Trạng Thái",minWidth:120,maxWidth:150}],[b,H]=i.useState(""),[v,T]=i.useState("success"),[V,L]=i.useState(!1),[F,I]=i.useState({}),[A,k]=i.useState({ghiChuCuaHang:"",ghiChuKhachHang:""}),[re,X]=i.useState(!1),[oe,M]=i.useState(!1),[a,D]=i.useState(""),[W,K]=i.useState(!1),d=()=>{L(!1)},w=async r=>{try{(await on(s,a,r)).status_code==201&&(H("Cập nhập trạng thái hóa đơn "+s+" thành công"),T("success"),L(!0),I({}),D(""),M(!1),k({ghiChuCuaHang:"",ghiChuKhachHang:""}),m())}catch(o){if(o.response&&o.response.data){const l=o.response.data.message.reduce((c,p)=>c.error_code<p.error_code?c:p);I({[l.field]:l.messages})}H(o.data.message.data.message),T("error"),L(!0)}},N=r=>{const{name:o,value:n}=r.target;k(l=>({...l,[o]:n}))},$=r=>{w(A)},le=()=>{X(!0)},Q=()=>{X(!1)},ce=()=>{M(!0)},E=r=>{D(r),ce()},q=()=>{M(!1),I({}),D(""),k({ghiChuCuaHang:"",ghiChuKhachHang:""})},U=()=>{K(!1),q()},_=()=>{K(!0)},ne=r=>{const o=[];return(r.trangThai==="CHO_THANH_TOAN"||r.trangThai==="CHO_XAC_NHAN"||r.trangThai==="CHO_GIAO"||r.trangThai==="DANG_GIAO"||r.trangThai==="XAC_NHAN"||r.trangThai==="DON_MOI")&&o.push(e.jsx(g,{item:!0,xs:3,children:e.jsx(O,{variant:"contained",color:"error",onClick:()=>E("HUY"),fullWidth:!0,children:"HỦY"})},"huy-button")),(r.trangThai==="DON_MOI"||r.trangThai==="CHO_XAC_NHAN")&&r.loaiHoaDon===1?o.push(e.jsx(g,{item:!0,xs:3,children:e.jsx(O,{variant:"contained",onClick:()=>E("XAC_NHAN"),fullWidth:!0,children:"XÁC NHẬN"})},"xac-nhan-button")):r.trangThai==="DON_MOI"&&r.loaiHoaDon===0?o.push(e.jsx(g,{item:!0,xs:3,children:e.jsx(O,{variant:"contained",onClick:()=>E("HOAN_THANH"),fullWidth:!0,children:"HOÀN THÀNH"})},"hoan-thanh-button")):r.trangThai==="XAC_NHAN"&&r.loaiHoaDon===1?o.push(e.jsx(g,{item:!0,xs:3,children:e.jsx(O,{variant:"contained",onClick:()=>E("CHO_GIAO"),fullWidth:!0,children:"CHỜ VẬN CHUYỂN"})},"hoan-thanh-button")):r.trangThai==="DANG_GIAO"&&r.loaiHoaDon===1&&o.push(e.jsx(g,{item:!0,xs:3,children:e.jsx(O,{variant:"contained",onClick:()=>E("HOAN_THANH"),fullWidth:!0,children:"HOÀN THÀNH"})},"hoan-thanh-button")),r.trangThai==="CHO_GIAO"&&r.loaiHoaDon===1&&o.push(e.jsx(g,{item:!0,xs:3,children:e.jsx(O,{variant:"contained",onClick:()=>E("DANG_GIAO"),fullWidth:!0,children:"VẬN CHUYỂN"})},"dang-giao-button")),e.jsx(g,{container:!0,spacing:2,children:o})};return console.log("BILL IN TIME LINE : ",x),e.jsxs(e.Fragment,{children:[e.jsx("div",{children:e.jsxs(g,{container:!0,spacing:2,padding:2,sx:{backgroundColor:"white",borderRadius:4},children:[e.jsx(g,{item:!0,xs:12,children:e.jsx(f,{variant:"h2",children:"Lịch sử đơn hàng"})}),e.jsx("div",{style:{display:"flex",overflowX:"auto",paddingBottom:"10px",justifyContent:"center"},children:t.map(r=>e.jsx(g,{item:!0,xs:12,sm:6,md:3,sx:{display:"flex",flexDirection:"column",alignItems:"center",marginLeft:2,minWidth:"300px"},children:e.jsx(Sn,{sx:{display:"flex",flexDirection:"column",alignItems:"center",width:"100%",textAlign:"center",height:"auto",maxWidth:"250px"},children:e.jsxs(tn,{sx:{padding:3,textAlign:"center"},children:[j(r.trangThai)," ",e.jsx(f,{variant:"h4",sx:{mt:2,textAlign:"center"},children:Ae(r.trangThai)}),e.jsx(f,{variant:"h5",sx:{mt:1,fontSize:"0.875rem",textAlign:"center"},children:r.ngayTao})]})})},r.id))}),e.jsx(g,{item:!0,xs:12,sx:{marginTop:0},children:e.jsxs(g,{container:!0,spacing:2,sx:{justifyContent:"space-between"},children:[e.jsx(g,{item:!0,xs:10,sx:{display:"flex",justifyContent:"flex-start"},children:ne(x)}),e.jsx(g,{item:!0,xs:2,children:e.jsx(we,{title:"Lịch sử hóa đơn",arrow:!0,placement:"top",children:e.jsx(O,{variant:"contained",color:"warning",fullWidth:!0,onClick:le,children:"Chi tiết"})})})]})})]})}),e.jsxs(xe,{open:re,onClose:Q,maxWidth:"lg",fullWidth:!0,children:[e.jsxs(me,{sx:{display:"flex",justifyContent:"space-between",alignItems:"center"},children:[e.jsxs(f,{variant:"h5",children:["Chi tiết lịch sử thay đổi hóa đơn : ",e.jsx("strong",{children:s})]}),e.jsx(O,{onClick:Q,children:"Đóng"})]}),e.jsx(de,{children:e.jsx(Pe,{component:Oe,style:{maxHeight:h,overflowY:"auto"},children:e.jsxs(_e,{children:[e.jsx(Fe,{children:e.jsx(pe,{children:y.map(r=>e.jsx(S,{style:{minWidth:r.minWidth,maxWidth:r.maxWidth},children:r.label},r.id))})}),e.jsx(Be,{children:t.map((r,o)=>e.jsxs(pe,{children:[e.jsx(S,{children:o+1}),e.jsx(S,{style:{minWidth:y[0].minWidth,maxWidth:y[0].maxWidth},children:r.ngayTao}),e.jsx(S,{style:{minWidth:y[1].minWidth,maxWidth:y[1].maxWidth},children:r.nguoiSua}),e.jsx(S,{style:{minWidth:y[3].minWidth,maxWidth:y[3].maxWidth,wordWrap:"break-word",whiteSpace:"normal"},children:r.ghiChuChoCuaHang}),e.jsx(S,{style:{minWidth:y[4].minWidth,maxWidth:y[4].maxWidth,wordWrap:"break-word",whiteSpace:"normal"},children:r.ghiChuChoKhachHang}),e.jsx(S,{style:{minWidth:y[2].minWidth,maxWidth:y[2].maxWidth},children:e.jsx(ee,{label:Ae(r.trangThai),sx:{backgroundColor:hn(r.trangThai),color:"#fff",width:"120px",borderRadius:"20px",display:"flex",justifyContent:"center",alignItems:"center"}})})]},o))})]})})})]}),e.jsxs(xe,{open:oe,onClose:q,"aria-labelledby":"alert-dialog-title","aria-describedby":"alert-dialog-description",children:[e.jsx(me,{id:"alert-dialog-title",children:"Xác nhận hành động"}),e.jsx(de,{children:e.jsxs(ke,{id:"alert-dialog-description",children:["Chuyên đối trạng thái hóa đơn từ ",C(x.trangThai)," thành ",C(a)]})}),e.jsx(de,{children:e.jsxs("div",{children:[e.jsx(Z,{label:"Ghi chú của cửa hàng",variant:"outlined",fullWidth:!0,multiline:!0,rows:4,name:"ghiChuCuaHang",value:A.ghiChuCuaHang,onChange:N,sx:{mb:2},required:!0,error:!!F.ghiChuCuaHang,helperText:F.ghiChuCuaHang||""}),e.jsx(Z,{label:"Ghi chú của khách hàng",variant:"outlined",fullWidth:!0,multiline:!0,rows:4,name:"ghiChuKhachHang",value:A.ghiChuKhachHang,onChange:N,sx:{mb:2}}),e.jsx(O,{variant:"contained",color:"primary",sx:{mb:2},onClick:()=>{_()},children:"Lưu"})]})})]}),e.jsxs(xe,{open:W,onClose:U,"aria-labelledby":"alert-dialog-title","aria-describedby":"alert-dialog-description",children:[e.jsx(me,{id:"alert-dialog-title"}),e.jsx(de,{children:e.jsxs(ke,{id:"alert-dialog-description",children:["Bạn muốn : ","     "," ",C(a)," hóa đơn ",e.jsxs("strong",{children:[" ",s]})]})}),e.jsxs(gn,{children:[e.jsx(O,{onClick:U,color:"secondary",children:"Hủy"}),e.jsx(O,{onClick:()=>{$(),K(!1)},color:"primary",autoFocus:!0,children:"Xác nhận"})]})]}),e.jsx(ge,{open:V,autoHideDuration:6e3,onClose:d,anchorOrigin:{vertical:"top",horizontal:"right"},children:e.jsx(fe,{onClose:d,severity:v,sx:{width:"100%"},children:b})})]})}function Hn(u){const{onLoading:s}=u,{id:t}=ue(),[m,x]=i.useState({}),[h,j]=i.useState([]),[C,y]=i.useState([]),[b,H]=i.useState([]),[v,T]=i.useState(""),[V,L]=i.useState(""),[F,I]=i.useState(""),[A,k]=i.useState(""),[re,X]=i.useState("success"),[oe,M]=i.useState(!1);i.useState({});const[a,D]=i.useState({ten:"",sdt:"",email:"",diaChi:"",tinh:"",tenTinh:"",huyen:"",tenHuyen:"",phuong:"",tenPhuong:"",ghiChu:"",tienShip:""}),[W,K]=i.useState({ten:"",sdt:"",email:"",tinh:"",huyen:"",phuong:""}),[d,w]=i.useState(!1),N=()=>w(!0),$=()=>{w(!1),D(n=>({...n,ten:a==null?void 0:a.tenKhachHang,tinh:a==null?void 0:a.tinh,huyen:a==null?void 0:a.huyen,phuong:a==null?void 0:a.phuong,tienShip:a==null?void 0:a.tienShip,sdt:a==null?void 0:a.sdt,email:a==null?void 0:a.email,diaChi:a==null?void 0:a.diaChi,ghiChu:a==null?void 0:a.ghiChu})),K({ten:"",sdt:"",email:"",tinh:"",huyen:"",phuong:""})};i.useEffect(()=>{d&&(le(),Q(),console.log("Load 1"))},[d]);const le=async()=>{try{const n=await Le(t);n.status_code===200&&(x(n.data),D(l=>({...l,ten:n.data.tenKhachHang,tinh:n.data.tinh,huyen:n.data.huyen,phuong:n.data.phuong,tienShip:n.data.tienShip,sdt:n.data.sdt,email:n.data.email,diaChi:n.data.diaChi,ghiChu:n.data.ghiChu})))}catch{k("Lỗi"),X("error"),M(!0)}};i.useEffect(()=>{Q(),console.log("Load 2")},[a.tinh]),console.log("BILL IN ADDRESS DIALOG : ",m);const Q=async()=>{const n=await Ee();if(j(n.data),a!=null&&a.tinh){const l=await je(a.tinh);y(l.data),L(""),I(""),H([])}if(a!=null&&a.huyen){const l=await Ce(a.huyen);H(l.data),I("")}if((a==null?void 0:a.tinh)!=null){T(a.tinh);const l=h.find(c=>c.ProvinceID===parseInt(a.tinh));D(c=>({...c,tinh:a.tinh,tenTinh:l?l.ProvinceName:""}))}if((a==null?void 0:a.huyen)!=null){L(a.huyen);const l=C.find(c=>c.DistrictID===parseInt(a.huyen));D(c=>({...c,huyen:a.huyen,tenHuyen:l?l.DistrictName:""}))}if((a==null?void 0:a.phuong)!=null){I(a.phuong);const l=b.find(c=>c.WardCode===a.phuong);D(c=>({...c,phuong:a.phuong,tenPhuong:l?l.WardName:""})),U(V,a.phuong)}},ce=async n=>{r(n);const l=n.target.value;T(l);const c=h.find(P=>P.ProvinceID===parseInt(l));D(P=>({...P,tinh:l,tenTinh:c?c.ProvinceName:"",phuong:"",huyen:""}));const p=await je(l);y(p.data),L(""),I(""),H([])},E=async n=>{r(n);const l=n.target.value;L(l);const c=C.find(P=>P.DistrictID===parseInt(l));D(P=>({...P,huyen:l,tenHuyen:c?c.DistrictName:""}));const p=await Ce(l);H(p.data),I("")},q=n=>{r(n);const l=n.target.value;I(n.target.value);const c=b.find(p=>p.WardCode===l);D(p=>({...p,phuong:l,tenPhuong:c?c.WardName:""})),U(V,n.target.value)},U=async(n,l)=>{const c=await Ge(n,l),p=await Re(n,l);new Date(c.data.leadtime*1e3).toISOString().slice(0,19).replace("T"," "),D(te=>({...te,tienShip:p.data.total}))};console.log("TP : ",h),console.log("Quận : ",C),console.log("Huyện : ",b),console.log("Form Data : ",a);const _=async n=>{var c,p,P,te,be,He,Te,Ie;n.preventDefault(),console.log("Form Data Guiwr  ĐI : ",a);const l={...a,ten:(c=a.ten)==null?void 0:c.trim(),sdt:(p=a.sdt)==null?void 0:p.trim(),email:(P=a.email)==null?void 0:P.trim(),diaChi:(te=a.diaChi)==null?void 0:te.trim(),tinh:(be=a.tinh)==null?void 0:be.trim(),huyen:(He=a.huyen)==null?void 0:He.trim(),phuong:(Te=a.phuong)==null?void 0:Te.trim(),ghiChu:(Ie=a.ghiChu)==null?void 0:Ie.trim(),tienShip:a.tienShip};try{(await ln(t,l)).status_code==201&&(D({ten:"",sdt:"",email:"",diaChi:"",tinh:"",tenTinh:"",huyen:"",tenHuyen:"",phuong:"",tenPhuong:"",ghiChu:"",tienShip:""}),K({tinh:"",huyen:"",phuong:"",email:"",sdt:"",ten:""}),s(),$(),k("Cập nhập địa chỉ thành công"),X("success"),M(!0))}catch(ae){if(console.log("Error Address : ",ae),ae.response&&ae.response.data){const De=ae.response.data.message,G={ten:"",sdt:"",email:"",tinh:"",huyen:"",phuong:""},We=De.filter(z=>[6002,6004,6006,6008,6009,6010,6011].includes(z.error_code));We.length>0?We.forEach(z=>{const he=z.field,J=z.messages;switch(he){case"email":G.email=J;break;case"sdt":G.sdt=J;break;case"ten":G.ten=J;break;case"tinh":G.tinh=J;break;case"huyen":G.huyen=J;break;case"phuong":G.phuong=J;break}}):De.forEach(z=>{z.field;const he=z.messages;switch(z.error_code){case 6003:G.email=he;break;case 6005:G.sdt=he;break;case 6007:G.ten=he;break}}),K(G)}else console.error("Có lỗi xảy ra:",ae),k("Có lỗi xảy ra khi cập nhật!"),X("error"),M(!0)}},ne=()=>{M(!1)},r=n=>{const{id:l,value:c}=n.target;D(p=>({...p,[l]:c}))},o=n=>new Intl.NumberFormat("vi-VN",{style:"currency",currency:"VND",minimumFractionDigits:0}).format(n);return e.jsxs(e.Fragment,{children:[e.jsx(we,{title:"Chọn địa chỉ cho đơn hàng",placement:"top",children:e.jsx(O,{variant:"contained",color:"primary",onClick:N,children:"Cập nhật địa chỉ"})}),e.jsxs(xe,{open:d,onClose:$,maxWidth:"md",fullWidth:!0,children:[e.jsx(me,{children:"Chọn Địa Chỉ"}),e.jsx(de,{children:e.jsxs("form",{onSubmit:_,className:"address-form",children:[e.jsxs("div",{className:"form-row",children:[e.jsxs("div",{className:"form-group",children:[e.jsx("input",{type:"text",id:"ten",placeholder:"Nhập tên của bạn",value:a.ten,onChange:r}),W.ten&&e.jsx("span",{className:"error-message",children:W.ten})]}),e.jsxs("div",{className:"form-group",children:[e.jsx("input",{type:"tel",id:"sdt",placeholder:"Nhập số điện thoại",value:a.sdt,onChange:r}),W.sdt&&e.jsx("span",{className:"error-message",children:W.sdt})]}),e.jsxs("div",{className:"form-group",children:[e.jsx("input",{id:"email",placeholder:"Nhập email",value:a.email,onChange:r}),W.email&&e.jsx("span",{className:"error-message",children:W.email})]})]}),e.jsx("div",{className:"form-group",children:e.jsx("textarea",{id:"diaChi",placeholder:"Nhập địa chỉ giao hàng",value:a.diaChi,onChange:r})}),e.jsxs("div",{className:"form-group",children:[e.jsxs("select",{id:"tinh",value:a.tinh,onChange:ce,children:[e.jsx("option",{value:"",disabled:!0,children:"Chọn Tỉnh/Thành Phố"}),h.map(n=>e.jsx("option",{value:n.ProvinceID,children:n.ProvinceName},n.ProvinceID))]}),W.tinh&&e.jsx("span",{className:"error-message",children:W.tinh})]}),e.jsxs("div",{className:"form-group",children:[e.jsxs("select",{id:"huyen",value:a.huyen,onChange:E,children:[e.jsx("option",{value:"",children:"Chọn Quận/Huyện"}),C.map(n=>e.jsx("option",{value:n.DistrictID,children:n.DistrictName},n.DistrictID))]}),W.huyen&&e.jsx("span",{className:"error-message",children:W.huyen})]}),e.jsxs("div",{className:"form-group",children:[e.jsxs("select",{id:"phuong",value:a.phuong,onChange:n=>{q(n)},children:[e.jsx("option",{value:"",children:"Chọn Phường/Xã"}),b.map(n=>e.jsx("option",{value:n.WardCode,children:n.WardName},n.WardCode))]}),W.phuong&&e.jsx("span",{className:"error-message",children:W.phuong})]}),e.jsx("div",{className:"form-group",children:e.jsx("textarea",{id:"ghiChu",placeholder:"Ghi chú",value:a.ghiChu,onChange:r})}),e.jsxs("div",{style:{display:"flex",flexDirection:"column",alignItems:"center"},children:[e.jsx("strong",{style:{fontSize:"24px"},children:o(a.tienShip)})," ",e.jsxs("div",{style:{display:"flex",gap:"10px",marginTop:"10px",justifyContent:"flex-end",width:"100%"},children:[e.jsx(O,{onClick:$,color:"secondary",children:"Hủy"}),e.jsx(O,{variant:"contained",color:"primary",type:"submit",children:"Lưu"})]})]})]})})]}),e.jsx(ge,{open:oe,autoHideDuration:6e3,onClose:ne,anchorOrigin:{vertical:"top",horizontal:"right"},children:e.jsx(fe,{onClose:ne,severity:re,sx:{width:"100%"},children:A})})]})}function Tn(u){const{bill:s,onLoading:t}=u,m=!(s.trangThai==="DANG_GIAO"||s.trangThai==="HOAN_THANH"||s.trangThai==="CHO_GIAO"||s.trangThai==="HUY");return e.jsx(e.Fragment,{children:e.jsxs(g,{container:!0,spacing:2,padding:3,sx:{backgroundColor:"white",borderRadius:4,mt:2,boxShadow:3},children:[e.jsx(g,{item:!0,xs:10,children:e.jsx(f,{variant:"h5",sx:{fontWeight:"bold"},children:"Thông tin đơn hàng"})}),e.jsx(g,{item:!0,xs:2,container:!0,justifyContent:"flex-end",children:m&&e.jsx(Hn,{onLoading:()=>{t()}})}),e.jsx(g,{item:!0,xs:4,children:e.jsxs(se,{display:"flex",alignItems:"center",children:[e.jsx(f,{variant:"body1",sx:{fontWeight:"bold"},children:"Mã:"}),e.jsx(f,{variant:"body1",sx:{ml:1,color:"#007bff",fontWeight:"bold"},children:s.ma})]})}),e.jsx(g,{item:!0,xs:4,children:e.jsxs(se,{display:"flex",alignItems:"center",children:[e.jsx(f,{variant:"body1",sx:{fontWeight:"bold"},children:"Tên khách hàng:"}),s.idKhachHang==null?e.jsx(ee,{label:"Khách lẻ",color:"info",sx:{ml:1}}):e.jsx(f,{variant:"body1",sx:{ml:1},children:s.tenKhachHang||s.idKhachHang})]})}),e.jsx(g,{item:!0,xs:4,children:e.jsxs(se,{display:"flex",alignItems:"center",children:[e.jsx(f,{variant:"body1",sx:{fontWeight:"bold"},children:"Trạng thái:"}),e.jsx(ee,{label:dn(s.trangThai),sx:{ml:1,backgroundColor:un(s.trangThai),color:"#fff"}})]})}),e.jsx(g,{item:!0,xs:4,children:e.jsxs(se,{display:"flex",alignItems:"center",children:[e.jsx(f,{variant:"body1",sx:{fontWeight:"bold"},children:"SĐT người nhận:"}),e.jsx(f,{variant:"body1",sx:{ml:1},children:s.sdt})]})}),e.jsx(g,{item:!0,xs:4,children:e.jsxs(se,{display:"flex",alignItems:"center",children:[e.jsx(f,{variant:"body1",sx:{fontWeight:"bold"},children:"Loại hóa đơn:"}),e.jsx(ee,{label:s.loaiHoaDon=="0"?"Tại quầy":"SHIP",color:s.loaiHoaDon=="0"?"primary":"success",sx:{ml:1}})]})}),e.jsx(g,{item:!0,xs:4,children:e.jsxs(se,{display:"flex",alignItems:"center",children:[e.jsx(f,{variant:"body1",sx:{fontWeight:"bold"},children:"Địa chỉ"}),e.jsx(f,{variant:"body1",sx:{ml:1},children:s.diaChi})]})})]})})}function In(u){const{id:s}=ue(),{bill:t}=u,[m,x]=i.useState([]),[h,j]=i.useState(!0),[C,y]=i.useState(null),b=async()=>{try{const v=await xn(s);v.status_code===200&&x(v.data)}catch{y("Không thể tải lịch sử thanh toán")}finally{j(!1)}};i.useEffect(()=>{b()},[s,t]);const H=()=>{y(null)};return e.jsxs(g,{container:!0,spacing:2,padding:3,sx:{backgroundColor:"white",borderRadius:4,mt:2,boxShadow:3},children:[e.jsx(g,{item:!0,xs:12,children:h?e.jsx(f,{children:"Đang tải..."}):e.jsx(Pe,{component:Oe,children:e.jsxs(_e,{children:[e.jsx(Fe,{children:e.jsxs(pe,{children:[" ",e.jsx(S,{children:"STT"}),e.jsx(S,{children:"Số tiền"}),e.jsx(S,{children:"Trạng thái"})," ",e.jsx(S,{children:"Ngày tạo"}),e.jsx(S,{children:"Người tạo"})," "]})}),e.jsx(Be,{children:Array.from(new Map(m.map(v=>[v.soTien,v])).values()).map((v,T)=>e.jsxs(pe,{children:[e.jsx(S,{children:T+1}),e.jsxs(S,{children:[e.jsx("strong",{children:v.soTien?v.soTien.toLocaleString()+" VNĐ":"Chưa có"})," "]}),e.jsx(S,{children:v.loaiThanhToan===0?e.jsx(ee,{label:"Thanh toán",color:"success",size:"small"}):e.jsx(ee,{label:"Trả Sau",color:"error",size:"small"})}),e.jsx(S,{children:v.ngayTao}),e.jsx(S,{children:v.nguoiTao?v.nguoiTao:"Chưa xác định"})]},T))})]})})}),C&&e.jsx(ge,{open:!!C,autoHideDuration:6e3,onClose:H,message:C})]})}function Dn(u){const{id:s}=ue(),{bill:t,onLoading:m,onReload:x}=u;i.useRef(null);const[h,j]=i.useState(!1),[C,y]=i.useState([]),[b,H]=i.useState([]),[v,T]=i.useState([]),[V,L]=i.useState(""),[F,I]=i.useState(""),[A,k]=i.useState(""),[re,X]=i.useState(!1),[oe,M]=i.useState(""),[a,D]=i.useState("success"),[W,K]=i.useState(!1);i.useState(!1);const[d,w]=i.useState({ten:"",tenKhachHang:"",sdt:"",email:"",diaChi:"",tinh:"",tenTinh:"",huyen:"",tenHuyen:"",phuong:"",tenPhuong:"",ghiChu:"",tienShip:"",loaiHoaDon:"",thanhToanSau:""}),[N,$]=i.useState({ten:"",sdt:"",email:"",tinh:"",huyen:"",phuong:""});i.useEffect(()=>{w({...t,ten:t.tenKhachHang||"",email:t.email||"",sdt:t.sdt||"",diaChi:t.diaChi||""}),$({}),j(t.loaiHoaDon==1),le()},[s,t]);const le=async()=>{const o=await Ee();if(y(o.data),t!=null&&t.tinh){const n=await je(t.tinh);H(n.data),I(""),k(""),T([])}if(t!=null&&t.huyen){const n=await Ce(t.huyen);T(n.data),k("")}if(t!=null&&t.tinh){const n=C.find(l=>l.ProvinceID===parseInt(t.tinh));if(w(l=>({...l,tinh:t.tinh,tenTinh:n?n.ProvinceName:""})),t!=null&&t.huyen){const l=b.find(c=>c.DistrictID===parseInt(t.huyen));if(w(c=>({...c,huyen:t.huyen,tenHuyen:l?l.DistrictName:""})),(t==null?void 0:t.phuong)!=null){k(t.phuong);const c=v.find(p=>p.WardCode===t.phuong);w(p=>({...p,phuong:t.phuong,tenPhuong:c?c.WardName:""})),q(l,t.phuong)}}}},Q=async o=>{_(o);const n=o.target.value;L(n);const l=C.find(p=>p.ProvinceID===parseInt(n));w(p=>({...p,tinh:n,tenTinh:l?l.ProvinceName:"",phuong:"",huyen:""}));const c=await je(n);H(c.data),I(""),k(""),T([])},ce=async o=>{_(o);const n=o.target.value;I(n);const l=b.find(p=>p.DistrictID===parseInt(n));w(p=>({...p,huyen:n,tenHuyen:l?l.DistrictName:""}));const c=await Ce(n);T(c.data),k("")},E=o=>{_(o);const n=o.target.value;k(n);const l=v.find(c=>c.WardCode===n);w(c=>({...c,phuong:n,tenPhuong:l?l.WardName:""})),q(F,n)},q=async(o,n)=>{console.log("to_district_id",o),console.log("to_ward_code",n);const l=await Ge(o,n),c=await Re(o,n),P=new Date(l.data.leadtime*1e3).toISOString().slice(0,19).replace("T"," ");w(te=>({...te,tienShip:c.data.total,ngayNhanHangDuKien:P}))},U=()=>{K(!1)},_=o=>{const{id:n,value:l}=o.target;w(c=>({...c,[n]:l}))},ne=o=>new Intl.NumberFormat("vi-VN",{style:"currency",currency:"VND",minimumFractionDigits:0}).format(o),r=()=>{X(!1)};return console.log("BILL : ",t),console.log("Form data  : ",d),e.jsxs(e.Fragment,{children:[e.jsxs(g,{container:!0,spacing:2,padding:2,sx:{backgroundColor:"white",marginTop:2,borderRadius:4},children:[e.jsx(g,{item:!0,xs:8,children:e.jsx(f,{variant:"h3",children:"Thông tin đơn hàng "})}),e.jsx(g,{item:!0,xs:4}),e.jsx(g,{mt:2,item:!0,xs:12,sx:{borderTop:1}}),e.jsx(g,{item:!0,xs:8,children:h&&s?e.jsxs(g,{container:!0,spacing:2,children:[e.jsx(g,{item:!0,xs:12,sm:4,children:e.jsx(Z,{disabled:!0,label:"Tên của bạn",id:"ten",placeholder:"Nhập tên của bạn",value:d.ten||"",onChange:_,error:!!N.ten,helperText:N.ten,fullWidth:!0,margin:"normal",InputLabelProps:{shrink:!!d.ten}})}),e.jsx(g,{item:!0,xs:12,sm:4,children:e.jsx(Z,{disabled:!0,label:"Số điện thoại",id:"sdt",placeholder:"Nhập số điện thoại",value:d.sdt,onChange:_,error:!!N.sdt,helperText:N.sdt,fullWidth:!0,margin:"normal",type:"tel",InputLabelProps:{shrink:!!d.sdt}})}),e.jsx(g,{item:!0,xs:12,sm:4,children:e.jsx(Z,{disabled:!0,label:"Email",id:"email",placeholder:"Nhập email",value:d.email,onChange:_,error:!!N.email,helperText:N.email,fullWidth:!0,margin:"normal",InputLabelProps:{shrink:!!d.email}})}),e.jsx(g,{item:!0,xs:12,children:e.jsx(Z,{disabled:!0,label:"Địa chỉ giao hàng",id:"diaChi",placeholder:"Nhập địa chỉ giao hàng",value:d.diaChi,onChange:_,fullWidth:!0,margin:"normal",multiline:!0,rows:4,InputLabelProps:{shrink:!!d.diaChi}})}),e.jsx(g,{item:!0,xs:12,sm:4,children:e.jsxs(ye,{fullWidth:!0,margin:"normal",children:[e.jsx(ve,{id:"tinh-label",children:"Tỉnh/Thành Phố"}),e.jsxs(Ne,{disabled:!0,labelId:"tinh-label",id:"tinh",value:d.tinh,onChange:Q,error:!!N.tinh,children:[e.jsx(ie,{value:"",disabled:!0,children:"Chọn Tỉnh/Thành Phố"}),C.map(o=>e.jsx(ie,{value:o.ProvinceID,children:o.ProvinceName},o.ProvinceID))]}),N.tinh&&e.jsx(f,{color:"error",children:N.tinh})]})}),e.jsx(g,{item:!0,xs:12,sm:4,children:e.jsxs(ye,{fullWidth:!0,margin:"normal",children:[e.jsx(ve,{id:"huyen-label",children:"Quận/Huyện"}),e.jsxs(Ne,{disabled:!0,labelId:"huyen-label",id:"huyen",value:d.huyen,onChange:ce,children:[e.jsx(ie,{value:"",children:"Chọn Quận/Huyện"}),b.map(o=>e.jsx(ie,{value:o.DistrictID,children:o.DistrictName},o.DistrictID))]}),N.huyen&&e.jsx(f,{color:"error",children:N.huyen})]})}),e.jsx(g,{item:!0,xs:12,sm:4,children:e.jsxs(ye,{fullWidth:!0,margin:"normal",children:[e.jsx(ve,{id:"phuong-label",children:"Phường/Xã"}),e.jsxs(Ne,{disabled:!0,labelId:"phuong-label",id:"phuong",value:d.phuong,onChange:E,children:[e.jsx(ie,{value:"",children:"Chọn Phường/Xã"}),v.map(o=>e.jsx(ie,{value:o.WardCode,children:o.WardName},o.WardCode))]}),N.phuong&&e.jsx(f,{color:"error",children:N.phuong})]})}),e.jsx(g,{item:!0,xs:12,children:e.jsx(Z,{disabled:!0,label:"Ghi chú",id:"ghiChu",placeholder:"Ghi chú",value:d.ghiChu,onChange:_,fullWidth:!0,margin:"normal",multiline:!0,rows:4,InputLabelProps:{shrink:!!d.ghiChu}})}),e.jsx(g,{item:!0,xs:12,style:{display:"flex",flexDirection:"column",alignItems:"center"},children:e.jsxs("strong",{style:{fontSize:"24px"},children:[" Phí ship : ",ne(d.tienShip)]})})]}):e.jsx(e.Fragment,{})}),e.jsxs(g,{item:!0,xs:4,children:[e.jsxs(f,{mt:1,variant:"h4",children:["Tổng tiền hàng: ",s?parseFloat((d==null?void 0:d.tongTienBanDau)||0).toLocaleString()||"0":0," VNĐ"]}),e.jsxs(f,{mt:1,variant:"h4",children:["Phiếu giảm giá : ",s&&(d==null?void 0:d.maPGG)||""]}),e.jsxs(f,{mt:1,variant:"h4",children:["Giảm giá: ",s&&parseFloat((d==null?void 0:d.giaTriPhieuGiamGia)||0).toLocaleString()||"0"," VNĐ"]}),e.jsxs(f,{mt:1,variant:"h4",children:["Giảm hạng: ",s&&parseFloat((d==null?void 0:d.tienGiamHangKhachHang)||0).toLocaleString()||"0"," VNĐ"]}),e.jsxs(f,{mt:1,variant:"h4",fontWeight:"bold",color:"error",children:["Tiền sau giảm giá: ",s&&parseFloat((d==null?void 0:d.tongTienPhaiTra)||0).toLocaleString()||"0"," VNĐ"]}),h&&e.jsxs(f,{mt:1,variant:"h4",children:["Tiền ship: ",s&&parseFloat((d==null?void 0:d.tienShip)||0).toLocaleString()||"0"," VNĐ"]}),e.jsxs(f,{mt:1,variant:"h4",fontWeight:"bold",color:"error",children:["Tổng tiền hóa đơn :"," ",s&&parseFloat((d==null?void 0:d.tongTienPhaiTra)+(h?d.tienShip:0)||0).toLocaleString()||"0"," VNĐ"]})]})]}),e.jsx(mn,{showDiaLogCoupon:re,handleCloseDiaLogCoupon:r,bill:t,onLoading:()=>{m()}}),e.jsx(ge,{open:W,autoHideDuration:2e3,onClose:U,anchorOrigin:{vertical:"top",horizontal:"right"},children:e.jsx(fe,{onClose:U,severity:a,sx:{width:"100%"},children:oe})})]})}function qn(){const{id:u}=ue(),s=an(),[t,m]=i.useState({}),[x,h]=i.useState([]),[j,C]=i.useState(""),[y,b]=i.useState("success"),[H,v]=i.useState(!1),T=()=>{v(!1)};i.useEffect(()=>{V(),L()},[u]);const V=async()=>{try{const A=await Le(u);A.status_code===200&&m(A.data)}catch(A){C(A.response.data.message),b("error"),v(!0)}},L=async()=>{const A=await cn(u);A.status_code===200&&h(A.data)},F=()=>{V(),L()},I=()=>{s("/hoa-don/danh-sach")};return console.log("BILL DETAIL => ID : ",u),console.log("BILL DETAIL => BILL : ",t),console.log("BILL DETAIL => HISTORY : ",x),e.jsxs(e.Fragment,{children:[e.jsx(sn,{color:"primary","aria-label":"back",sx:{position:"fixed",top:170,right:15},onClick:I,children:e.jsx(rn,{})}),e.jsx(bn,{data:x,onLoading:F,bill:t}),e.jsx(Tn,{bill:t,onLoading:F}),e.jsx(In,{bill:t}),e.jsx(pn,{onLoading:F,bill:t,title:"Hóa đơn chi tiết"}),e.jsx(Dn,{onLoading:F,bill:t,onReload:F}),e.jsx(ge,{open:H,autoHideDuration:2e3,onClose:T,anchorOrigin:{vertical:"top",horizontal:"center"},children:e.jsx(fe,{onClose:T,variant:"filled",severity:y,sx:{width:"100%"},children:j})})]})}export{qn as default};

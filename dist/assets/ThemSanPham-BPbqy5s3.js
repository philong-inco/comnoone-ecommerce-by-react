import{y as Je,r as n,ao as be,j as t,J as it,f as Se,m as ne,aU as Bt,as as Wt,h as Xe,T as Gt,d as Kt,c as A,u as qt,n as ct,t as lt,o as rt,ak as $t,B as zt,e as ut,I as dt,b as Jt,M as Le}from"./index-BIssY3ES.js";import{D as ht,a as Xt,b as Yt,c as Qt}from"./DialogTitle-CNaKTOiI.js";import{D as Zt}from"./DialogContentText-BUcCQ4bP.js";import{d as en}from"./Close-magJj_Ah.js";import{I as tn}from"./IconDeviceFloppy-B40dChj2.js";import{I as pt,A as nn}from"./AlertDialogSlide-YVTCY67s.js";import{T as sn,a as an,b as on,c as nt,d as cn}from"./TableRow-DRER82D7.js";import{T as O}from"./TableCell-BTwc7VYq.js";import{S as ln}from"./Switch-CEN9aA3z.js";import{d as mt}from"./Add-CSRCs860.js";import{M as ft}from"./MenuItem-DXPtbgVP.js";import{c as rn}from"./sanPham-BcjQyRXE.js";import{c as un}from"./chiTietSanPham-DW_mEhre.js";import{B as ge}from"./react-toastify.esm-CyyOKOyt.js";import{N as xe}from"./notification-B40vY8uZ.js";import{A as dn}from"./Autocomplete-CB6AoPGv.js";import"./back-end-vuWvP0DO.js";import"./Close-DqFvtwpG.js";var hn=Je("circle-check","IconCircleCheck",[["path",{d:"M12 12m-9 0a9 9 0 1 0 18 0a9 9 0 1 0 -18 0",key:"svg-0"}],["path",{d:"M9 12l2 2l4 -4",key:"svg-1"}]]),pn=Je("circle-plus","IconCirclePlus",[["path",{d:"M3 12a9 9 0 1 0 18 0a9 9 0 0 0 -18 0",key:"svg-0"}],["path",{d:"M9 12h6",key:"svg-1"}],["path",{d:"M12 9v6",key:"svg-2"}]]),mn=Je("upload","IconUpload",[["path",{d:"M4 17v2a2 2 0 0 0 2 2h12a2 2 0 0 0 2 -2v-2",key:"svg-0"}],["path",{d:"M7 9l5 -5l5 5",key:"svg-1"}],["path",{d:"M12 4l0 12",key:"svg-2"}]]),fn={};/**
 * @license React
 * use-sync-external-store-shim.production.min.js
 *
 * Copyright (c) Facebook, Inc. and its affiliates.
 *
 * This source code is licensed under the MIT license found in the
 * LICENSE file in the root directory of this source tree.
 */var he=n;function gn(e,s){return e===s&&(e!==0||1/e===1/s)||e!==e&&s!==s}var xn=typeof Object.is=="function"?Object.is:gn,Sn=he.useState,Cn=he.useEffect,bn=he.useLayoutEffect,jn=he.useDebugValue;function vn(e,s){var i=s(),m=Sn({inst:{value:i,getSnapshot:s}}),l=m[0].inst,u=m[1];return bn(function(){l.value=i,l.getSnapshot=s,Ue(l)&&u({inst:l})},[e,i,s]),Cn(function(){return Ue(l)&&u({inst:l}),e(function(){Ue(l)&&u({inst:l})})},[e]),jn(i),i}function Ue(e){var s=e.getSnapshot;e=e.value;try{var i=s();return!xn(e,i)}catch{return!0}}function yn(e,s){return s()}var wn=typeof window>"u"||typeof window.document>"u"||typeof window.document.createElement>"u"?yn:vn;fn.useSyncExternalStore=he.useSyncExternalStore!==void 0?he.useSyncExternalStore:wn;const z=()=>{},_=z(),Be=Object,F=e=>e===_,te=e=>typeof e=="function",ke=(e,s)=>({...e,...s}),En=e=>te(e.then),Te=new WeakMap;let Tn=0;const Ce=e=>{const s=typeof e,i=e&&e.constructor,m=i==Date;let l,u;if(Be(e)===e&&!m&&i!=RegExp){if(l=Te.get(e),l)return l;if(l=++Tn+"~",Te.set(e,l),i==Array){for(l="@",u=0;u<e.length;u++)l+=Ce(e[u])+",";Te.set(e,l)}if(i==Be){l="#";const d=Be.keys(e).sort();for(;!F(u=d.pop());)F(e[u])||(l+=u+":"+Ce(e[u])+",");Te.set(e,l)}}else l=m?e.toJSON():s=="symbol"?e.toString():s=="string"?JSON.stringify(e):""+e;return l},$=new WeakMap,We={},Re={},gt="undefined",Ye=typeof window!=gt,Ke=typeof document!=gt,Rn=(e,s)=>{const i=$.get(e);return[()=>!F(s)&&e.get(s)||We,m=>{if(!F(s)){const l=e.get(s);s in Re||(Re[s]=l),i[5](s,ke(l,m),l||We)}},i[6],()=>!F(s)&&s in Re?Re[s]:!F(s)&&e.get(s)||We]};let qe=!0;const Dn=()=>qe,[$e,ze]=Ye&&window.addEventListener?[window.addEventListener.bind(window),window.removeEventListener.bind(window)]:[z,z],kn=()=>{const e=Ke&&document.visibilityState;return F(e)||e!=="hidden"},An=e=>(Ke&&document.addEventListener("visibilitychange",e),$e("focus",e),()=>{Ke&&document.removeEventListener("visibilitychange",e),ze("focus",e)}),Pn=e=>{const s=()=>{qe=!0,e()},i=()=>{qe=!1};return $e("online",s),$e("offline",i),()=>{ze("online",s),ze("offline",i)}},In={isOnline:Dn,isVisible:kn},Vn={initFocus:An,initReconnect:Pn};be.useId;const xt=!Ye||"Deno"in window,Ge=typeof navigator<"u"&&navigator.connection,st=!xt&&Ge&&(["slow-2g","2g"].includes(Ge.effectiveType)||Ge.saveData),St=e=>{if(te(e))try{e=e()}catch{e=""}const s=e;return e=typeof e=="string"?e:(Array.isArray(e)?e.length:e)?Ce(e):"",[e,s]};let Nn=0;const at=()=>++Nn,On=0,_n=1,Hn=2;async function Fn(...e){const[s,i,m,l]=e,u=ke({populateCache:!0,throwOnError:!0},typeof l=="boolean"?{revalidate:l}:l||{});let d=u.populateCache;const p=u.rollbackOnError;let g=u.optimisticData;const T=S=>typeof p=="function"?p(S):p!==!1,C=u.throwOnError;if(te(i)){const S=i,h=[],x=s.keys();for(const y of x)!/^\$(inf|sub)\$/.test(y)&&S(s.get(y)._k)&&h.push(y);return Promise.all(h.map(j))}return j(i);async function j(S){const[h]=St(S);if(!h)return;const[x,y]=Rn(s,h),[J,X,pe,je]=$.get(s),se=()=>{const I=J[h];return(te(u.revalidate)?u.revalidate(x().data,S):u.revalidate!==!1)&&(delete pe[h],delete je[h],I&&I[0])?I[0](Hn).then(()=>x().data):x().data};if(e.length<3)return se();let D=m,P;const M=at();X[h]=[M,0];const Y=!F(g),ae=x(),oe=ae.data,ie=ae._c,L=F(ie)?oe:ie;if(Y&&(g=te(g)?g(L,oe):g,y({data:g,_c:L})),te(D))try{D=D(L)}catch(I){P=I}if(D&&En(D))if(D=await D.catch(I=>{P=I}),M!==X[h][0]){if(P)throw P;return D}else P&&Y&&T(P)&&(d=!0,y({data:L,_c:_}));if(d&&!P)if(te(d)){const I=d(D,L);y({data:I,error:_,_c:_})}else y({data:D,error:_,_c:_});if(X[h][1]=at(),Promise.resolve(se()).then(()=>{y({_c:_})}),P){if(C)throw P;return}return D}}const ot=(e,s)=>{for(const i in e)e[i][0]&&e[i][0](s)},Mn=(e,s)=>{if(!$.has(e)){const i=ke(Vn,s),m={},l=Fn.bind(_,e);let u=z;const d={},p=(C,j)=>{const S=d[C]||[];return d[C]=S,S.push(j),()=>S.splice(S.indexOf(j),1)},g=(C,j,S)=>{e.set(C,j);const h=d[C];if(h)for(const x of h)x(j,S)},T=()=>{if(!$.has(e)&&($.set(e,[m,{},{},{},l,g,p]),!xt)){const C=i.initFocus(setTimeout.bind(_,ot.bind(_,m,On))),j=i.initReconnect(setTimeout.bind(_,ot.bind(_,m,_n)));u=()=>{C&&C(),j&&j(),$.delete(e)}}};return T(),[e,l,T,u]}return[e,$.get(e)[4]]},Ln=(e,s,i,m,l)=>{const u=i.errorRetryCount,d=l.retryCount,p=~~((Math.random()+.5)*(1<<(d<8?d:8)))*i.errorRetryInterval;!F(u)&&d>u||setTimeout(m,p,l)},Un=(e,s)=>Ce(e)==Ce(s),[Ct,Bn]=Mn(new Map);ke({onLoadingSlow:z,onSuccess:z,onError:z,onErrorRetry:Ln,onDiscarded:z,revalidateOnFocus:!0,revalidateOnReconnect:!0,revalidateIfStale:!0,shouldRetryOnError:!0,errorRetryInterval:st?1e4:5e3,focusThrottleInterval:5*1e3,dedupingInterval:2*1e3,loadingTimeout:st?5e3:3e3,compare:Un,isPaused:()=>!1,cache:Ct,mutate:Bn,fallback:{}},In);n.createContext({});const Wn="$inf$",bt=Ye&&window.__SWR_DEVTOOLS_USE__,Gn=bt?window.__SWR_DEVTOOLS_USE__:[],Kn=()=>{bt&&(window.__SWR_DEVTOOLS_REACT__=be)},qn=e=>(s,i,m)=>e(s,i&&((...u)=>{const[d]=St(s),[,,,p]=$.get(Ct);if(d.startsWith(Wn))return i(...u);const g=p[d];return F(g)?i(...u):(delete p[d],g)}),m);Gn.concat(qn);Kn();be.use;const $n=be.forwardRef(function(s,i){return t.jsx(it,{direction:"up",ref:i,...s})});function zn({title:e,message:s,open:i,setOpen:m,serialNumbers:l,setSerialNumbers:u}){const d=()=>{m(!1),u(p)},[p,g]=n.useState({});n.useEffect(()=>{g({...l})},[l]);const T=C=>{const j=C.target.value;console.log("1Seri từ con: ",j),g(S=>({...S,value:j}))};return t.jsx(be.Fragment,{children:t.jsxs(ht,{open:i,TransitionComponent:$n,keepMounted:!0,onClose:d,"aria-describedby":"alert-dialog-slide-description",sx:{minHeight:"80%",minWidth:"70%"},children:[t.jsx(Xt,{children:e}),t.jsx(Yt,{children:t.jsxs(Zt,{id:"alert-dialog-slide-description",children:[s,t.jsx("br",{}),t.jsx("br",{}),t.jsx(Se,{fullWidth:!0,rows:10,value:p.value,onChange:T,id:"serial",label:"Danh sách serial number",multiline:!0,maxRows:10})]})}),t.jsx(Qt,{children:t.jsx(ne,{color:"secondary",onClick:d,children:"Nhập Serial"})})]})})}const Jn=({setUrlImages:e})=>{const s=n.useRef(),i=n.useRef();n.useEffect(()=>{s.current=window.cloudinary,i.current=s.current.createUploadWidget({cloudName:"dse71o3zv",uploadPreset:"demo_shop"},function(l,u){if(!l&&u&&u.event==="success"){let d=u.info.secure_url;e(p=>[d,...p])}})},[e]);const m=()=>{i.current.open()};return t.jsx(ne,{title:"Tải ảnh lên",sx:{color:"#FFFFFF"},onClick:m,children:t.jsx(pn,{stroke:2})})},Xn=n.forwardRef(function(s,i){return t.jsx(it,{direction:"up",ref:i,...s})}),Yn=({openAlbum:e,setOpenAlbum:s,listAnh:i,nameColor:m,idColor:l,onUpdateImage:u})=>{const[d,p]=n.useState([]);n.useEffect(()=>{p([...i])},[i]);const[g,T]=n.useState([]),C=h=>{if(g.includes(h))T(x=>x.filter(y=>y!==h));else if(g.length<3)T(x=>[...g,h]);else return};n.useEffect(()=>{console.log("imageSelect: ",g)},[g]);const j=()=>{u(l,g),S()};n.useEffect(()=>{},[d]);const S=()=>{s(null)};return t.jsx(n.Fragment,{children:t.jsxs(ht,{fullScreen:!0,open:!0,onClose:S,TransitionComponent:Xn,children:[t.jsx(Bt,{sx:{position:"relative",backgroundColor:"#5F35B1"},children:t.jsxs(Wt,{children:[t.jsx(Xe,{edge:"start",onClick:S,"aria-label":"close",sx:{color:"#FFFFFF"},children:t.jsx(en,{})}),t.jsxs(Gt,{sx:{ml:2,flex:1,color:"#FFFFFF"},variant:"h3",component:"div",children:['Chọn tối đa 3 ảnh cho màu "',m,'"']}),t.jsx(ne,{title:"Lưu",autoFocus:!0,color:"inherit",onClick:j,children:t.jsx(tn,{stroke:2})}),t.jsx(Jn,{setUrlImages:p})]})}),t.jsx("div",{style:{padding:" 20px"},children:t.jsx("div",{style:{display:"flex",justifyContent:"space-between",flexWrap:"wrap"},children:d.map((h,x)=>t.jsxs("div",{style:{width:"16%",position:"relative"},children:[g.includes(h)&&t.jsx(hn,{style:{backgroundColor:"#BBEDFC",color:"#5E35B1",position:"absolute",top:"5px",right:"5px",borderRadius:"7px"},stroke:2}),t.jsx("img",{onClick:()=>C(h),src:h,style:{width:"100%",cursor:"pointer"}})]},x))})})]})})},Qn=({listKeySort:e,variantListFromParent:s,showMessage:i,setResult:m,actionFather:l,listAnh:u,mauSacChecked:d})=>{const[p,g]=n.useState([]),T=(o,r)=>{let f="";for(let b=o;b>=0;b--)f+=r[e[b]].ten;return f},C={},j={};p.forEach((o,r)=>{e.forEach((f,b)=>{const R=`${T(b,o)}`;C[R]===void 0&&(C[R]=0),C[R]++,j[R]===void 0&&(j[R]=r)})});const[S,h]=n.useState(""),x=o=>{const r=o.target.value.replace(/\D/g,"");h(r)},y=()=>{if(console.log("priceAll: ",S),confirm("Xác nhận thay đổi toàn bộ giá bán thành: ",S)){const o=p.map(r=>({...r,giaBan:S}));g(o)}},[J,X]=n.useState([]),[pe,je]=n.useState(!1);n.useEffect(()=>{console.log("imageList: ",J)},[J]);const[se,D]=n.useState(null),P=o=>{D(o)},[M,Y]=n.useState([]);n.useEffect(()=>{console.log("mauSacCheckedSelectAnhcha: ",M)},[M]);const ae=(o,r)=>{let f=M.map(b=>b.id===o?{...b,urls:r}:b);Y(f)};n.useEffect(()=>{const o=d.map(r=>({id:r.id,ten:r.ten,urls:[]}));Y(o)},[d]),n.useEffect(()=>{g([]),g([...s])},[s]),n.useEffect(()=>{X([...u])},[u]),n.useEffect(()=>{console.log("variantList:",p)},[p]);const oe=o=>r=>{const f=r.target.value.replace(/\D/g,""),b=p.map((w,R)=>R===o?{...w,giaBan:f}:w);g(b)},ie=o=>r=>{let f=0;r.target.checked&&(f=1);const b=p.map((w,R)=>R===o?{...w,trangThai:f}:w);g(b)},[L,I]=n.useState(!1),[ce,Ae]=n.useState({index:-1,value:""});n.useEffect(()=>{console.log(ce)},[ce]);const Pe=o=>{Ae(r=>({index:o,value:p[o].serialNumberList.join(",")})),I(!0)},U=async o=>{const r=[];async function f(N){let H=null;try{H=await A.get(`http://localhost:8080/api/serial-number/exist-for-add?ma=${N}`)}catch(W){W.response&&(H=W.response.data)}return console.log(H.data),H.data?(r.push(N),console.log("listSerialExist: ",r),!0):!1}let b=o.value.split(",").map(N=>N.trim());b.length===1&&b[0]===""&&(b=[]);const w=[];console.log("ListValid before: ",w);for(const N of b){const H=await f(N);console.log("Kết quả hàm: ",H),H==!1&&(console.log("vào nè"),w.push(N))}console.log("ListValid after: ",w);const R=p.map((N,H)=>H===o.index?{...N,serialNumberList:w}:N);r.length>0&&i("Đã loại bỏ các serial đã tồn tại sau","Danh sách: "+r.join(",")),g(R)},Ie=()=>{const o=B();if(console.log("check: ",o),o.check)m(p),l();else{let r="";o.message!==""&&(r+="Giá không hợp lệ tại dòng "+o.message,r=r.substring(0,r.length-2)),o.isDulicateSeri&&(r+=`
 | Serial Number nhập trong danh sách bị trùng lặp.`),i(r)}},B=()=>{console.log("run validate");let o={check:!0,message:"",seriVuaNhap:[],isDulicateSeri:!1},r=[];return p.forEach((f,b)=>{M.forEach(w=>{f.mauSac.id===w.id&&(f.anhSanPham=w.urls)}),(f.giaBan===""||isNaN(f.giaBan)||parseFloat(f.giaBan)<=0)&&(o.check=!1,o.message+=b+1+", "),Array.isArray(f.serialNumberList)?console.log("...item.serialNumberList: ",f.serialNumberList):console.log("k phải array"),r=[...r,...f.serialNumberList]}),console.log("seriVuaNhap ",r),new Set(r).size!=r.length&&(o.check=!1,o.isDulicateSeri=!0),o};function ve(o,r="vi-VN",f="VND"){return new Intl.NumberFormat(r,{style:"decimal",currency:f}).format(o)}return t.jsxs("div",{children:[t.jsxs("div",{style:{textAlign:"right"},children:[t.jsx(Se,{label:"Nhập giá chung",id:"outlined-start-adornment",sx:{m:1,width:"25ch"},value:ve(S),onChange:x}),t.jsx(ne,{onClick:y,variant:"contained",color:"secondary",sx:{height:"47px",borderRadius:"7px",marginTop:"10px"},children:t.jsx(pt,{})})]}),t.jsx(sn,{component:Kt,children:t.jsxs(an,{children:[t.jsx(on,{children:t.jsxs(nt,{children:[t.jsx(O,{children:"STT"}),e.map(o=>o==="RAM"&&t.jsx(O,{children:"Ram"},"ram")||o==="CPU"&&t.jsx(O,{children:"Cpu"},"cpu")||o==="oCung"&&t.jsx(O,{children:"Ổ cứng"},"oCung")||o==="mauSac"&&t.jsx(O,{children:"Màu sắc"},"mauSac")),t.jsx(O,{children:"Số lượng"}),t.jsx(O,{children:"Giá bán"}),t.jsx(O,{children:"Hành động"})]})}),t.jsx(cn,{children:p.map((o,r)=>t.jsx(t.Fragment,{children:t.jsxs(nt,{children:[t.jsx(O,{children:r+1}),e.map((f,b)=>{const R=`${T(b,o)}`;return j[R]===r?t.jsx(O,{rowSpan:C[R],children:o[e[b]].ten},f):null}),t.jsx(O,{children:o.serialNumberList.length}),t.jsx(O,{children:t.jsx(Se,{value:ve(o.giaBan),onChange:oe(r),label:"Giá bán",variant:"standard",fullWidth:!0,color:"secondary"})}),t.jsx(O,{children:t.jsxs("div",{style:{display:"flex",alignItems:"center"},children:[t.jsx(mn,{onClick:()=>Pe(r),style:{color:"#2195F2",fontSize:"20px",backgroundColor:"#bbedfc",borderRadius:"7px",padding:"5px",cursor:"pointer"}}),t.jsx(ln,{onChange:ie(r),defaultChecked:o.trangThai===1,color:"secondary"})]})})]},r)}))})]})}),t.jsx("div",{style:{padding:"20px",margin:"50px 0 20px 0",textAlign:"center"},children:t.jsx("h3",{style:{fontSize:"20px",fontWeight:"bolder",marginBottom:"20px"},children:"Chọn ảnh theo màu sắc"})}),M.map(o=>t.jsxs("div",{style:{display:"flex",margin:"10px 0",minHeight:"115px"},children:[t.jsxs("div",{style:{width:"30%"},children:[t.jsxs(ne,{color:"secondary",variant:"outlined",onClick:()=>P(o.id),children:["Màu ",o.ten]}),se===o.id&&t.jsx(Yn,{openAlbum:pe,setOpenAlbum:P,listAnh:J,nameColor:o.ten,idColor:o.id,onUpdateImage:ae},o.id)]}),t.jsx("div",{style:{width:"70%",display:"flex"},children:o.urls.map(r=>t.jsx("div",{style:{width:"100px",margin:"5px"},children:t.jsx("img",{src:r,style:{width:"100%"}})}))})]},o.id)),t.jsx("div",{style:{textAlign:"center",padding:"20px 0"},children:t.jsx(ne,{title:"Xác nhận",variant:"contained",color:"secondary",sx:{height:"47px",borderRadius:"7px",marginTop:"10px"},onClick:Ie,children:"Xác nhận"})}),t.jsx("div",{children:t.jsx(zn,{open:L,setOpen:I,title:"Nhập serial number cho biến thể",message:"Hãy phân cách các serial bằng dấu phẩy (,)",serialNumbers:ce,setSerialNumbers:U})})]})},De=({list:e,setListChecked:s,nameDropDown:i})=>{const u={PaperProps:{style:{maxHeight:224,width:150}}};function d(h,x,y){return{fontWeight:x.indexOf(h)===-1?y.typography.fontWeightRegular:y.typography.fontWeightMedium}}const p=qt();n.useState([]);const[g,T]=n.useState([]),[C,j]=n.useState([]);n.useEffect(()=>{const h=C.map(x=>x);s(h),T(C.map(x=>x.ten))},[C]);const S=h=>{const{value:x}=h.target;j(x)};return t.jsx("div",{children:t.jsxs(ct,{sx:{width:220},children:[t.jsx(lt,{id:"demo-multiple-chip-label",color:"secondary",children:i}),t.jsx(rt,{labelId:"demo-multiple-chip-label",id:"demo-multiple-chip",color:"secondary",multiple:!0,sx:{minHeight:"62.9px"},value:C,onChange:S,input:t.jsx($t,{id:"select-multiple-chip",label:"Chip"}),renderValue:h=>t.jsx(zt,{sx:{display:"flex",flexWrap:"wrap",gap:.5},children:h.map(x=>t.jsx(ut,{label:x.ten,sx:{backgroundColor:"#EDE7F6"}},x.id))}),endAdornment:t.jsx(dt,{style:{marginRight:"10px"},position:"end",children:t.jsx(Xe,{children:t.jsx(mt,{})})}),MenuProps:u,children:e.map(h=>t.jsx(ft,{value:h,style:d(h.ten,C.map(x=>x.ten),p),children:h.ten},h.id))})]})})},ee=({list:e,setValueSelect:s,name:i})=>{const[m,l]=n.useState({});n.useEffect(()=>{s(m.id)},[m]);const u=d=>{l(d.target.value)};return t.jsxs(ct,{required:!0,sx:{m:1,width:"23.4%"},children:[t.jsx(lt,{id:"demo-simple-select-required-label",color:"secondary",children:i}),t.jsx(rt,{labelId:"demo-simple-select-required-label",id:"demo-simple-select-required",color:"secondary",value:m,label:i,onChange:u,sx:{minHeight:"62.9px"},renderValue:d=>Object.keys(d).length>0?t.jsx(ut,{sx:{backgroundColor:"#EDE7F6"},label:d.ten},d.id):null,endAdornment:t.jsx(dt,{style:{marginRight:"10px"},position:"end",children:t.jsx(Xe,{children:t.jsx(mt,{})})}),children:e.map(d=>t.jsx(ft,{value:d,children:d.ten},d.id))})]})},Ss=()=>{const e=Jt(),[s,i]=n.useState(!1),[m,l]=n.useState(""),[u,d]=n.useState(""),[p,g]=n.useState(["https://photo.znews.vn/w660/Uploaded/mdf_eioxrd/2021_07_06/2.jpg","https://photo.znews.vn/w660/Uploaded/mdf_eioxrd/2021_07_06/2.jpg"]),[T,C]=n.useState([]),[j,S]=n.useState([]),[h,x]=n.useState([]),[y,J]=n.useState([]),[X,pe]=n.useState([]),[je,se]=n.useState([]),[D,P]=n.useState([]),[M,Y]=n.useState([]),[ae,oe]=n.useState([]),[ie,L]=n.useState([]),[I,ce]=n.useState([]),[Ae,Pe]=n.useState([]),[U,Ie]=n.useState(""),[B,ve]=n.useState(""),[o,r]=n.useState([]),[f,b]=n.useState([]),[w,R]=n.useState([]),[N,H]=n.useState([]),[W,jt]=n.useState(""),[le,vt]=n.useState(""),[re,yt]=n.useState(""),[ue,wt]=n.useState(""),[de,Et]=n.useState(""),[me,Tt]=n.useState(""),[ye,Rt]=n.useState(""),[Dt,kt]=n.useState([]),[Zn,Qe]=n.useState(!0);n.useEffect(()=>{At()},[]);const At=async()=>{const a=await A.get("http://localhost:8080/api/san-pham/all-list-active"),c=await A.get("http://localhost:8080/api/nhu-cau/all-list-active"),k=await A.get("http://localhost:8080/api/thuong-hieu/all-list-active"),E=await A.get("http://localhost:8080/api/ram/all-list-active"),V=await A.get("http://localhost:8080/api/mau-sac/all-list-active"),q=await A.get("http://localhost:8080/api/cpu/all-list-active"),Ve=await A.get("http://localhost:8080/api/vga/all-list-active"),Ne=await A.get("http://localhost:8080/api/webcam/all-list-active"),Oe=await A.get("http://localhost:8080/api/o-cung/all-list-active"),_e=await A.get("http://localhost:8080/api/man-hinh/all-list-active"),He=await A.get("http://localhost:8080/api/he-dieu-hanh/all-list-active"),Fe=await A.get("http://localhost:8080/api/ban-phim/all-list-active"),Me=await A.get("http://localhost:8080/api/anh-san-pham/list");C(a.data.data),S(c.data.data),x(k.data.data),J(E.data.data),pe(V.data.data),se(q.data.data),P(Ve.data.data),Y(Ne.data.data),oe(Oe.data.data),L(_e.data.data),ce(He.data.data),Pe(Fe.data.data),kt(Me.data.data)},[we,Ze]=n.useState([]),[Q,fe]=n.useState({}),[G,Pt]=n.useState([]),[v,K]=n.useState([]),It=async a=>{const c=await A.get(`http://localhost:8080/api/san-pham/exist-name?name=${a}`);return console.log("checkUniqueNameProduct: ",c),c.data.code!==999},Vt=async()=>{let a=!0;(W===""||ye===""||me===""||de===""||ue===""||re===""||le===""||U===""||B===""||W===void 0||ye===void 0||me===void 0||de===void 0||ue===void 0||re===void 0||le===void 0||U===void 0||B===void 0)&&(a=!1,Ee("Hãy nhập thông tin sản phẩm"));let c=await It(me);c||Ee("Tên sản phẩm đã tồn tại"),console.log("--VGAChecked: ",W),console.log("--moTa: ",ye),console.log("--tenSanPham: ",me),console.log("--banPhimChecked: ",de),console.log("--heDieuHanhChecked: ",ue),console.log("--manHinhChecked: ",re),console.log("--webcamChecked: ",le),console.log("--nhuCauChecked: ",U),console.log("--thuongHieuChecked: ",B),console.log("--check: ",a),console.log("--resultVariant.length > 0: ",v.length>0),console.log("--isUnique: ",c),a==!0&&v.length>0&&c&&Lt()};n.useEffect(()=>{console.log("resultVariant truyền lên cha: ",v)},[v]),n.useEffect(()=>{if(Object.keys(Q).length>0){const c=Object.keys(Q);c.sort((E,V)=>Q[E].length-Q[V].length);const k=c.filter(E=>E!=="mauSac");k.push("mauSac"),console.log("Key sau khi đổi chỗ: ",k),Pt(k)}},[Q]);const[Nt,Ot]=n.useState([]);n.useEffect(()=>{console.log("Giá trị selectedKey: ",G),G.length===4?(et(0,_t),Ot(G)):G.length!==4&&G.length!==0&&Ee("Thiếu thông tin để tạo biến thể","Vui lòng chọn đủ 4 thuộc tính Ram, Cpu, Ổ cứng, màu sắc")},[G]),n.useEffect(()=>{p.length>=f.length*3&&Qe(!1),console.log("urlImages: ",p)},[p]),n.useEffect(()=>{f.length>0&&Qe(!0)},[f]);const[_t,Z]=n.useState({giaBan:"",trangThai:1,RAM:null,CPU:null,oCung:null,mauSac:null,banPhim:null,manHinh:null,VGA:null,heDieuHanh:null,webcam:null,serialNumberList:[],anhSanPham:[]});n.useState({ten:"",moTa:"",trangThai:"",nhuCauId:"",thuongHieuId:""}),n.useEffect(()=>{if(Z(a=>({...a,VGA:W})),v.length>0){const a=v.map(c=>({...c,VGA:W}));K(a)}},[W]),n.useEffect(()=>{if(Z(a=>({...a,heDieuHanh:ue})),v.length>0){const a=v.map(c=>({...c,heDieuHanh:ue}));K(a)}},[ue]),n.useEffect(()=>{if(Z(a=>({...a,webcam:le})),v.length>0){const a=v.map(c=>({...c,webcam:le}));K(a)}},[le]),n.useEffect(()=>{if(Z(a=>({...a,manHinh:re})),v.length>0){const a=v.map(c=>({...c,manHinh:re}));K(a)}},[re]),n.useEffect(()=>{if(Z(a=>({...a,banPhim:de})),v.length>0){const a=v.map(c=>({...c,banPhim:de}));K(a)}},[de]),n.useEffect(()=>{if(Z(a=>({...a,thuongHieu:B})),v.length>0){const a=v.map(c=>({...c,thuongHieu:B}));K(a)}},[B]),n.useEffect(()=>{if(Z(a=>({...a,nhuCau:U})),v.length>0){const a=v.map(c=>({...c,nhuCau:U}));K(a)}},[U]);const Ht=()=>{fe({}),Ze([]),o.length>0&&fe(a=>({...a,RAM:[...o]})),w.length>0&&fe(a=>({...a,CPU:[...w]})),N.length>0&&fe(a=>({...a,oCung:[...N]})),f.length>0&&fe(a=>({...a,mauSac:[...f]}))},et=(a,c)=>{if(console.log("chạy generateVariant"),a===G.length){Ze(V=>[...V,c]);return}const k=G[a],E=Q[k];console.log("nameKey: ",k),console.log("valueOfKey: ",E),E.forEach(V=>{const q={...c,[k]:{...V}};et(a+1,q)})};n.useEffect(()=>{console.log("productVarriant: ",we),console.log("selectAttribute: ",Q)},[we]);const Ee=(a,c)=>{l(a),d(c),i(!0)},Ft=async({ten:a,trangThai:c,moTa:k,nhuCauId:E,thuongHieuId:V})=>{const q=await rn({ten:a,trangThai:c,moTa:k,nhuCauId:E,thuongHieuId:V});if(!q){ge.error(xe.ERROR);return}return q},Mt=async({giaBan:a,trangThai:c,banPhimId:k,cpuId:E,heDieuHanhId:V,manHinhId:q,mauSacId:Ve,ramId:Ne,sanPhamId:Oe,vgaId:_e,webcamId:He,ocungId:Fe,listSerialNumber:Me,listUrlAnhSanPham:Ut})=>{const tt=await un({giaBan:a,trangThai:c,banPhimId:k,cpuId:E,heDieuHanhId:V,manHinhId:q,mauSacId:Ve,ramId:Ne,sanPhamId:Oe,vgaId:_e,webcamId:He,ocungId:Fe,listSerialNumber:Me,listUrlAnhSanPham:Ut});if(!tt){ge.error(xe.ERROR);return}return tt},Lt=async()=>{const a=await Ft({ten:me,trangThai:1,moTa:ye,nhuCauId:U,thuongHieuId:B});if(a.code===999){ge.error(xe.ERROR);return}v.forEach(async(c,k)=>{let E={giaBan:c.giaBan,trangThai:c.trangThai,banPhimId:c.banPhim,cpuId:c.CPU.id,heDieuHanhId:c.heDieuHanh,manHinhId:c.manHinh,mauSacId:c.mauSac.id,ramId:c.RAM.id,vgaId:c.VGA,webcamId:c.webcam,ocungId:c.oCung.id,sanPhamId:a.id,listSerialNumber:"",listUrlAnhSanPham:""};c.serialNumberList.length>0&&(E.listSerialNumber=c.serialNumberList.join(",")),c.anhSanPham.length>0&&(E.listUrlAnhSanPham=c.anhSanPham.join(",")),console.log("product: ",E);const V=await Mt(E);if(!V||V.code===999){ge.error(xe.ERROR);return}k===v.length-1&&(ge.success(xe.CREATED),e("/sanpham/danhsach"))})};return t.jsxs(t.Fragment,{children:[t.jsxs(Le,{children:[t.jsxs("div",{children:[t.jsxs("div",{style:{padding:"10px"},children:[t.jsx("h3",{children:"Nhập thông tin sản phẩm"}),t.jsx("div",{style:{margin:"15px 0",display:"flex",justifyContent:"space-between"},children:t.jsx(dn,{sx:{width:"68%"},id:"free-solo-demo",freeSolo:!0,options:T.map(a=>a.ten),renderInput:a=>t.jsx(Se,{...a,id:"nameProduct",label:"Tên sản phẩm",variant:"outlined",color:"secondary",onChange:c=>Tt(c.target.value)})})}),t.jsx("div",{children:t.jsx(Se,{id:"descriptionProduct",label:"Mô tả sản phẩm",multiline:!0,rows:4,variant:"outlined",fullWidth:!0,color:"secondary",onChange:a=>Rt(a.target.value)})})]}),t.jsxs("div",{children:[t.jsx(ee,{list:h,setValueSelect:ve,name:"Thương hiệu"}),t.jsx(ee,{list:j,setValueSelect:Ie,name:"Nhu cầu"}),t.jsx(ee,{list:D,setValueSelect:jt,name:"VGA"}),t.jsx(ee,{list:M,setValueSelect:vt,name:"Webcam"}),t.jsx(ee,{list:ie,setValueSelect:yt,name:"Màn hình"}),t.jsx(ee,{list:Ae,setValueSelect:Et,name:"Bàn phím"}),t.jsx(ee,{list:I,setValueSelect:wt,name:"Hệ điều hành"})]})]}),t.jsx("div",{children:t.jsx(nn,{title:m,message:u,open:s,setOpen:i})})]}),t.jsx(Le,{style:{marginTop:"20px"},children:t.jsxs("div",{style:{padding:"10px"},children:[t.jsx("h3",{style:{fontSize:"20px",fontWeight:"bolder",marginBottom:"20px"},children:"Chọn các thuộc tính"}),t.jsxs("div",{style:{display:"flex",justifyContent:"space-between",flexWrap:"wrap"},children:[t.jsx(De,{list:y,setListChecked:r,nameDropDown:"Ram"}),t.jsx(De,{list:je,setListChecked:R,nameDropDown:"CPU"}),t.jsx(De,{list:ae,setListChecked:H,nameDropDown:"Ổ cứng"}),t.jsx(De,{list:X,setListChecked:b,nameDropDown:"Màu sắc"}),t.jsx(ne,{variant:"contained",onClick:Ht,color:"secondary",sx:{height:"60px",borderRadius:"7px"},children:t.jsx(pt,{})})]})]})}),t.jsx(Le,{style:{marginTop:"20px"},children:t.jsx("div",{style:{padding:"10px"},children:we.length>0&&t.jsx(Qn,{listKeySort:Nt,variantListFromParent:we,showMessage:Ee,setResult:K,actionFather:Vt,listAnh:Dt,mauSacChecked:f})})})]})};export{Ss as default};

import{ae as ie,af as oe,j as e,r as n,a4 as le,B as d,G as i,J as h,N as v,z as ce,K as de,ad as he,I as g,a9 as ge,V as ue,a as D,Z as u}from"./index-r6x2ypbK.js";import{d as xe}from"./Add-CPRtuant.js";import{d as me}from"./Visibility-BGJibKHk.js";import{d as je,a as pe}from"./DeleteSweep-8fHq3n30.js";import{d as fe}from"./Delete-D7kMYDYS.js";import{l as Ce,d as be,s as ye,a as Se}from"./dotGiamGiaService-C39TQBo2.js";import{M as x}from"./MenuItem-Cpk-906f.js";import{T as Te,a as ve,b as De,c as k,d as ke}from"./TableRow-CTax1pli.js";import{T as t}from"./TableCell-7vhPCx5T.js";import{S as we}from"./Switch-CiuMTXHa.js";import{P as Ge}from"./Pagination-DzifC26g.js";import{a as B,c as M,b as F,D as O}from"./DialogTitle-BvLtCuRU.js";import{D as _}from"./DialogContentText-BFvDpVta.js";import{S as Ie,A as Pe}from"./Snackbar-Dh6eEEaa.js";import"./LastPage-DUSx3Tck.js";import"./Close-C-vCMd3Z.js";var w={},Re=oe;Object.defineProperty(w,"__esModule",{value:!0});var H=w.default=void 0,Be=Re(ie()),Me=e;H=w.default=(0,Be.default)((0,Me.jsx)("path",{d:"M15.5 14h-.79l-.28-.27C15.41 12.59 16 11.11 16 9.5 16 5.91 13.09 3 9.5 3S3 5.91 3 9.5 5.91 16 9.5 16c1.61 0 3.09-.59 4.23-1.57l.27.28v.79l5 4.99L20.49 19zm-6 0C7.01 14 5 11.99 5 9.5S7.01 5 9.5 5 14 7.01 14 9.5 11.99 14 9.5 14"}),"Search");function Ze(){const[m,K]=n.useState(1),[W,E]=n.useState(0),[G,N]=n.useState([]),[s,j]=n.useState({tenOrMa:"",giaTri:"",trangThai:"",ngayBatDau:"",ngayKetThuc:"",size:6}),[A,p]=n.useState(!1),[$,l]=n.useState(""),[z,f]=n.useState("success"),[L,C]=n.useState(!1),[X,b]=n.useState(!1),[y,S]=n.useState(null),[q,V]=n.useState(null),T=le(),o=async()=>{debugger;const a=await Ce(s);N(a.data.content),E(a.data.totalPages)};n.useEffect(()=>{o();const a=setInterval(()=>{o()},2e3);return()=>clearInterval(a)},[m,s]),n.useEffect(()=>{o()},[s,m]);const c=a=>{j({...s,[a.target.name]:a.target.value})},J=(a,r)=>{K(r),j({...s,page:r-1})},Z=a=>{T(`/dotgiamgia/cauhinhdotgiamgia/view/${a}`)},Q=a=>{T(`/dotgiamgia/cauhinhdotgiamgia/edit/${a}`)},U=a=>{S(a),C(!0)},I=()=>{C(!1)},Y=()=>{T("/dotgiamgia/cauhinhdotgiamgia")},ee=async()=>{await be(y),C(!1),o(),l("Hủy đợt giảm giá thành công"),f("success"),p(!0)},P=()=>{b(!1),S(null)},ae=(a,r)=>{S(a),V(r),b(!0)},te=async()=>{const a=q===1?1:4;try{if(a===4)if((await ye(y)).status===200)l("Phiếu giảm giá đã được bắt đầu áp dụng.");else throw new Error("Có lỗi xảy ra khi bắt đầu áp dụng phiếu giảm giá.");else if(a===1)if((await Se(y)).status===200)l("Phiếu giảm giá đã được ngừng áp dụng.");else throw new Error("Có lỗi xảy ra khi ngừng áp dụng phiếu giảm giá.");f("success"),o()}catch(r){console.error(r),l(r.message||"Cập nhật trạng thái thất bại."),f("error")}finally{p(!0),b(!1)}},R=()=>{p(!1)},ne=a=>{switch(a){case 0:return"gray";case 1:return"green";case 2:return"red";case 3:return"#FFA500";case 4:return"black";default:return"blue"}},re=a=>{switch(a){case 0:return"Sắp Diễn Ra";case 1:return"Đang Diễn Ra";case 2:return"Đã Diễn Ra";case 3:return"Đã Hủy";case 4:return"Đang tạm dừng";default:return"Không xác định"}},se=()=>{j({tenOrMa:"",ngayBatDau:"",ngayKetThuc:"",trangThai:""})};return e.jsxs("div",{children:[e.jsx(d,{sx:{backgroundColor:"#f0f0f0",p:2,borderRadius:2,marginBottom:2},children:e.jsxs(d,{sx:{backgroundColor:"white",p:2,borderRadius:2},children:[e.jsxs(i,{container:!0,spacing:3,alignItems:"center",p:2,children:[e.jsx(i,{item:!0,xs:12,sm:3,children:e.jsx(h,{fullWidth:!0,variant:"outlined",children:e.jsx(v,{name:"tenOrMa",label:"Tên hoặc Mã",value:s.tenOrMa,onChange:c,variant:"outlined",InputProps:{startAdornment:e.jsx(ce,{position:"start",children:e.jsx(H,{})})},fullWidth:!0})})}),e.jsx(i,{item:!0,xs:12,sm:2,children:e.jsx(h,{fullWidth:!0,variant:"outlined",children:e.jsx(v,{name:"ngayBatDau",type:"datetime-local",label:"Ngày Bắt Đầu",InputLabelProps:{shrink:!0},value:s.ngayBatDau,onChange:c,fullWidth:!0})})}),e.jsx(i,{item:!0,xs:12,sm:2,children:e.jsx(h,{fullWidth:!0,variant:"outlined",children:e.jsx(v,{name:"ngayKetThuc",type:"datetime-local",label:"Ngày Kết Thúc",InputLabelProps:{shrink:!0},value:s.ngayKetThuc,onChange:c,fullWidth:!0})})}),e.jsx(i,{item:!0,xs:12,sm:2,children:e.jsxs(h,{fullWidth:!0,variant:"outlined",children:[e.jsx(de,{children:"Trạng Thái"}),e.jsxs(he,{name:"trangThai",value:s.trangThai,onChange:c,fullWidth:!0,label:"Trạng Thái",children:[e.jsx(x,{value:"",children:"Tất cả"}),e.jsx(x,{value:"0",children:"Sắp Diễn Ra"}),e.jsx(x,{value:"1",children:"Đang Diễn Ra"}),e.jsx(x,{value:"2",children:"Đã Diễn Ra"})]})]})}),e.jsx(i,{item:!0,xs:12,sm:2,children:e.jsx(g,{onClick:se,color:"secondary",sx:{border:"1px solid",borderRadius:2,padding:1,backgroundColor:"#f5f5f5",transition:"background-color 0.3s ease, box-shadow 0.3s ease",boxShadow:"0 4px 8px rgba(0, 0, 0, 0.1)","&:hover":{backgroundColor:"#e0e0e0",boxShadow:"0 6px 12px rgba(0, 0, 0, 0.15)"},"& .MuiSvgIcon-root":{transition:"transform 0.3s ease"},"&:hover .MuiSvgIcon-root":{transform:"rotate(360deg)"}},children:e.jsx(je,{})})})]}),e.jsx(ge,{color:"primary","aria-label":"add",sx:{position:"fixed",bottom:16,right:16,boxShadow:3},onClick:Y,children:e.jsx(xe,{})})]})}),e.jsx(Te,{component:ue,children:e.jsxs(ve,{children:[e.jsx(De,{children:e.jsxs(k,{children:[e.jsx(t,{children:"STT"}),e.jsx(t,{children:"Mã đợt giảm giá"}),e.jsx(t,{children:"Tên đợt giảm giá"}),e.jsx(t,{children:"Ngày bắt đầu"}),e.jsx(t,{children:"Ngày kết thúc"}),e.jsx(t,{children:"Trạng thái"}),e.jsx(t,{children:"Chi tiết"}),e.jsx(t,{children:"Hành động"})]})}),e.jsx(ke,{children:G.length>0?G.map((a,r)=>e.jsxs(k,{children:[e.jsx(t,{children:r+1}),e.jsx(t,{children:a.ma}),e.jsx(t,{children:a.ten}),e.jsx(t,{children:a.thoiGianBatDau}),e.jsx(t,{children:a.thoiGianKetthuc}),e.jsx(t,{children:e.jsx(d,{sx:{backgroundColor:ne(a.trangThai),color:"white",padding:"5px 10px",borderRadius:"8px",textAlign:"center",width:"120px",fontWeight:"bold"},children:re(a.trangThai)})}),e.jsx(t,{children:e.jsx(D,{title:"Xem chi tiết",children:e.jsx(g,{onClick:()=>Z(a.id),children:e.jsx(me,{})})})}),e.jsxs(t,{children:[(a.trangThai===0||a.trangThai===4)&&e.jsx(e.Fragment,{children:e.jsx(g,{color:"secondary",onClick:()=>Q(a.id),children:e.jsx(D,{title:"Chỉnh sửa",children:e.jsx(pe,{})})})}),(a.trangThai===0||a.trangThai===1||a.trangThai===4)&&e.jsx(e.Fragment,{children:e.jsx(D,{title:"Hủy đợt giảm giá",children:e.jsx(g,{color:"error",onClick:()=>U(a.id),children:e.jsx(fe,{})})})}),(a.trangThai===1||a.trangThai===4)&&e.jsx(e.Fragment,{children:e.jsx(we,{checked:a.trangThai===1,onChange:()=>ae(a.id,a.trangThai)})})]})]},a.id)):e.jsx(k,{children:e.jsx(t,{colSpan:7,align:"center",children:"Không có phiếu giảm giá nào"})})})]})}),e.jsx(d,{display:"flex",justifyContent:"center",my:2,children:e.jsx(Ge,{count:W,page:m,onChange:J,color:"primary"})}),e.jsxs(B,{open:L,onClose:I,children:[e.jsx(M,{children:"Xác nhận hủy phiếu"}),e.jsx(F,{children:e.jsx(_,{children:"Bạn có chắc chắn muốn hủy phiếu này? Hành động này không thể hoàn tác."})}),e.jsxs(O,{children:[e.jsx(u,{onClick:I,color:"primary",children:"Hủy bỏ"}),e.jsx(u,{onClick:ee,color:"secondary",autoFocus:!0,children:"Xác nhận"})]})]}),e.jsxs(B,{open:X,onClose:P,"aria-labelledby":"alert-dialog-title","aria-describedby":"alert-dialog-description",children:[e.jsx(M,{id:"alert-dialog-title",children:"Xác nhận thay đổi trạng thái?"}),e.jsx(F,{children:e.jsx(_,{id:"alert-dialog-description",children:"Bạn có chắc chắn muốn thay đổi trạng thái của đợt giảm giá này không?"})}),e.jsxs(O,{children:[e.jsx(u,{onClick:P,children:"Hủy"}),e.jsx(u,{onClick:te,autoFocus:!0,children:"Đồng ý"})]})]}),e.jsx(Ie,{open:A,autoHideDuration:3e3,onClose:R,anchorOrigin:{vertical:"top",horizontal:"center"},children:e.jsx(Pe,{onClose:R,severity:z,variant:"filled",children:$})})]})}export{Ze as default};

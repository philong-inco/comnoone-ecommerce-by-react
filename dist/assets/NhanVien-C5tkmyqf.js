import{z as Ee,E as Ne,j as e,r as o,b as De,M as _e,B as M,G as j,F as k,f as ze,k as H,p as Ve,m as Pe,d as Ie,q as Re,i as x,T as v,A as Fe,e as E}from"./index-BmIX3_3w.js";import{u as N,w as $e}from"./xlsx-ChUIJHMt.js";import{g as p,p as ae}from"./request-BL6vn_vs.js";import{d as Ae}from"./Add-CGKpRTw5.js";import{d as We,I as Ke}from"./InsertDriveFile-C-NfAWl4.js";import{M as D}from"./MenuItem-ByEqL40d.js";import{R as Be,a as Le}from"./RadioGroup-CzZcL5RC.js";import{F as Me}from"./FormControlLabel-nmLt3JMn.js";import{F as G}from"./Fab-DCOhgBUb.js";import{T as He,a as Ge,b as Oe,c as O,d as Ye}from"./TableRow-COUS1y_I.js";import{T as r}from"./TableCell-BAoyJBRv.js";import{S as Xe}from"./Switch-DlsO41Jn.js";import{T as qe}from"./TablePagination-DvJQlFJ5.js";import{D as Y,a as X,b as q,c as J}from"./DialogTitle-DH_KFVlR.js";import{S as Je}from"./Snackbar-OfUUkmGu.js";import"./SwitchBase-CzMjO0Un.js";import"./KeyboardArrowRight-ZUvQPM7X.js";import"./LastPage-YRoveXFG.js";var _={},Qe=Ne;Object.defineProperty(_,"__esModule",{value:!0});var ne=_.default=void 0,Ue=Qe(Ee()),Ze=e;ne=_.default=(0,Ue.default)((0,Ze.jsx)("path",{d:"M21 10h-8.35C11.83 7.67 9.61 6 7 6c-3.31 0-6 2.69-6 6s2.69 6 6 6c2.61 0 4.83-1.67 5.65-4H13l2 2 2-2 2 2 4-4.04zM7 15c-1.65 0-3-1.35-3-3s1.35-3 3-3 3 1.35 3 3-1.35 3-3 3"}),"Key");const Q=async s=>{try{return await p(`/nhan_vien/all?pageNo=${s}`)}catch(t){throw console.error("Error fetching Employees:",t),t}},ea=async()=>{try{return await p("/nhan_vien/danhsachnhanvien")}catch(s){throw console.error("Error fetching Employees:",s),s}},U=async(s,t,c)=>{try{return await p(`/nhan_vien/search?pageNo=${s}&search=${c}`)}catch(l){throw console.error("Error fetching Employees by keyword:",l),l}},Z=async(s,t,c)=>{try{debugger;return await p(`/nhan_vien/searchtrangthai?pageNo=${s}&trangThai=${c}`)}catch(l){throw console.error("Error fetching Employees by status:",l),l}},ee=async(s,t,c)=>{try{debugger;return await p(`/nhan_vien/searchgioitinh?pageNo=${s}&gioiTinh=${c}`)}catch(l){throw console.error("Error fetching Employees by sex:",l),l}},aa=async s=>{try{return await ae(`/nhan_vien/remove/${s}`)}catch(t){throw console.error("Error deleting Employee:",t),t}},na=async s=>{try{return await ae(`/nhan_vien/rollBackStatus/${s}`)}catch(t){throw console.error("Error rolling back Employee status:",t),t}},ta=async s=>{try{debugger;const t=await p(`/nhan_vien/sendemailforgotpassword/${s}`)}catch(t){throw console.log("Error sent email password"),t}},Ta=()=>{const[s,t]=o.useState(1);o.useState(0);const[c,l]=o.useState(""),[d,y]=o.useState(""),[te,b]=o.useState(!1),[z,V]=o.useState(null),[w,P]=o.useState(null),[I,re]=o.useState([]),[ra,se]=o.useState([]),[g,S]=o.useState(""),[sa,R]=o.useState(!1);o.useState("");const[oe,C]=o.useState(!1),[m,f]=o.useState({open:!1,message:"",severity:"success"}),[T,ie]=o.useState(null),le=[{id:"",name:"Tất Cả"},{id:"0",name:"Đã Nghỉ Việc"},{id:"1",name:"Đang Làm Việc"}],F=De(),[n,$]=o.useState({page:0,size:5}),[ce,he]=o.useState(0),A=async()=>{try{debugger;let a;c?a=await U(n.page,n.size,c):d?a=await Z(n.page,n.size,d):g!==""?a=await ee(n.page,n.size,g):a=await Q(n.page,n.size),re(a.content),he(a.totalElements)}catch(a){console.log(a)}},de=(a,i)=>{$(u=>({...u,page:i}))},ge=a=>{$({...n,size:parseInt(a.target.value,10),page:0})},ue=async()=>{let a;try{a=await ea(),se(a)}catch(i){console.log(i)}};o.useEffect(()=>{A()},[n.page,n.size,c,d,g]),o.useEffect(()=>{ue()},[]);const xe=a=>{switch(a){case 0:return e.jsx(E,{label:"Đã Nghỉ Việc",color:"default",style:{backgroundColor:"#f44336",color:"#fff"}});case 1:return e.jsx(E,{label:"Đang Làm Việc",color:"success",style:{backgroundColor:"#4caf50",color:"#fff"}});default:return e.jsx(E,{label:"Không xác định",color:"warning",style:{backgroundColor:"#ff9800",color:"#fff"}})}},pe=a=>{l(a.target.value),t(1),y(""),S("")},me=a=>{debugger;y(a.target.value),t(1),l(""),S("")},fe=a=>{const i=a.target.value;S(i),t(1),l(""),y("")},je=async()=>{b(!1);try{w===0?await aa(z):await na(z),A()}catch(a){console.error("Error updating employee status:",a)}},W=()=>{b(!1),V(null),P(null)},K=a=>{const i={year:"numeric",month:"2-digit",day:"2-digit"};return new Date(a).toLocaleDateString("vi-VN",i)},ye=(a,i)=>{V(a),P(i===1?0:1),b(!0)},be=()=>{F("/nhanvien/configuration")},we=a=>{F(`/nhanvien/configuration/${a}`)},Se=new Date().getFullYear();Array.from(new Array(101),(a,i)=>Se-i);const Ce=async()=>{try{let a;c?a=await U(n.page,n.size,c):d?a=await Z(n.page,n.size,d):g!==""?a=await ee(n.page,n.size,g):a=await Q(n.page,n.size);const i=N.json_to_sheet(a.content.map((h,ve)=>({STT:ve+1+(n.page-1)*n.size,"Hình Ảnh":h.hinhAnh,Mã:h.ma,Tên:h.ten,"Ngày Sinh":K(h.ngaySinh),"Số Điện Thoại":h.sdt,Email:h.email,"Địa Chỉ":h.diaChi,"Trạng Thái":h.trangThai===1?"Đang Làm Việc":"Đã Nghỉ Việc"}))),u=N.book_new();N.book_append_sheet(u,i,"Danh Sách Nhân Viên"),$e(u,"danh_sach_nhan_vien.xlsx")}catch(a){console.log("Lỗi khi xuất file Excel:",a)}},Te=a=>{C(!0),ie(a)},B=()=>{C(!1)},ke=async a=>{if(!a){f({open:!0,message:"Email không hợp lệ.",severity:"error"});return}R(!0);try{await ta(a),f({open:!0,message:"Email reset mật khẩu đã được gửi!",severity:"success"})}catch{f({open:!0,message:"Có lỗi xảy ra khi gửi email.",severity:"error"})}finally{R(!1),C(!1)}},L=()=>{f({...m,open:!1})};return e.jsxs(_e,{style:{textAlign:"center"},children:[e.jsxs(M,{sx:{backgroundColor:"white",boxShadow:"0 4px 8px rgba(0.3, 0.3, 0.2, 0.3)",borderRadius:"8px",p:3,mb:3,width:"100%"},children:[e.jsxs(j,{container:!0,spacing:3,children:[e.jsxs(j,{item:!0,xs:12,sm:6,md:4,children:[e.jsx(k,{component:"legend",sx:{fontWeight:"bold",mb:1},children:"Tìm Kiếm"}),e.jsx(ze,{label:"Tìm kiếm theo mã, tên, email, số điện thoại",value:c,onChange:pe,variant:"outlined",fullWidth:!0})]}),e.jsxs(j,{item:!0,xs:12,sm:6,md:4,children:[e.jsx(k,{component:"legend",sx:{fontWeight:"bold",mb:1},children:"Giới Tính"}),e.jsxs(H,{fullWidth:!0,children:[e.jsx(Ve,{id:"gender-select-label",children:"-- Chọn giới tính --"}),e.jsxs(Pe,{labelId:"gender-select-label",id:"gender-select",value:g,onChange:fe,children:[e.jsx(D,{value:"",children:e.jsx("em",{children:"-- Chọn giới tính --"})}),e.jsx(D,{value:1,children:"Nam"}),e.jsx(D,{value:0,children:"Nữ"})]})]})]}),e.jsxs(j,{item:!0,xs:12,sm:12,md:4,children:[e.jsx(k,{component:"legend",sx:{fontWeight:"bold",mb:1},children:"Trạng Thái"}),e.jsx(H,{component:"fieldset",fullWidth:!0,children:e.jsx(Be,{row:!0,value:d,onChange:me,children:le.map(a=>e.jsx(Me,{value:a.id,control:e.jsx(Le,{}),label:a.name},a.id))})})]})]}),e.jsxs(M,{sx:{position:"fixed",top:350,right:16,display:"flex",flexDirection:"column",alignItems:"center",zIndex:1300},children:[e.jsx(G,{color:"primary","aria-label":"add",title:"Thêm Nhân Viên",sx:{height:"60px",width:"60px",backgroundColor:"#007bff",color:"#fff",boxShadow:"0px 8px 15px rgba(0, 123, 255, 0.3)",transition:"all 0.3s ease",marginBottom:"10px","&:hover":{backgroundColor:"#0056b3",boxShadow:"0px 15px 20px rgba(0, 86, 179, 0.4)",transform:"translateY(-3px)"},"&:active":{backgroundColor:"#004080",boxShadow:"0px 5px 10px rgba(0, 64, 128, 0.2)",transform:"translateY(1px)"}},onClick:be,children:e.jsx(Ae,{sx:{fontSize:"30px"}})}),e.jsx(G,{color:"primary","aria-label":"export",title:"Xuất danh sách nhân viên",sx:{height:"60px",width:"60px",backgroundColor:"#28a745",color:"#fff",boxShadow:"0px 8px 15px rgba(40, 167, 69, 0.3)",transition:"all 0.3s ease","&:hover":{backgroundColor:"#218838",boxShadow:"0px 15px 20px rgba(33, 136, 56, 0.4)",transform:"translateY(-3px)"},"&:active":{backgroundColor:"#1e7e34",boxShadow:"0px 5px 10px rgba(30, 126, 52, 0.2)",transform:"translateY(1px)"}},onClick:Ce,children:e.jsx(We,{sx:{fontSize:"30px"}})})]})]}),e.jsx(He,{component:Ie,children:e.jsxs(Ge,{children:[e.jsx(Oe,{children:e.jsxs(O,{children:[e.jsx(r,{children:"STT"}),e.jsx(r,{children:"Hình Ảnh"}),e.jsx(r,{children:"Mã"}),e.jsx(r,{children:"Tên"}),e.jsx(r,{children:"Ngày Sinh"}),e.jsx(r,{children:"Số Điện Thoại"}),e.jsx(r,{children:"Email"}),e.jsx(r,{children:"Địa Chỉ"}),e.jsx(r,{children:"Trạng Thái"}),e.jsx(r,{children:"Hành Động"})]})}),e.jsx(Ye,{children:I.length>0&&I.map((a,i)=>{const u=K(a.ngaySinh);return e.jsxs(O,{children:[e.jsx(r,{children:i+1+(s-1)*5}),e.jsx(r,{children:e.jsx(Re,{alt:a.ten,src:a.hinhAnh,sx:{width:100,height:100}})}),e.jsx(r,{children:a.ma}),e.jsx(r,{children:a.ten}),e.jsx(r,{children:u}),e.jsx(r,{children:a.sdt}),e.jsx(r,{children:a.email}),e.jsx(r,{children:a.diaChi}),e.jsx(r,{children:xe(a.trangThai)}),e.jsxs(r,{children:[e.jsx(x,{className:"btn btn-link",title:"Sửa Nhân Viên",children:e.jsx(Ke,{stroke:2,onClick:()=>we(a.id)})}),e.jsx(Xe,{checked:a.trangThai===1,onChange:()=>ye(a.id,a.trangThai),color:"primary",title:"Trạng thái nhân viên"}),e.jsx(x,{title:"Cấp lại mật khẩu cho nhân viên",onClick:()=>Te(a.email),variant:"text",sx:{minWidth:0,padding:0},children:e.jsx(ne,{sx:{fontSize:30,color:"green"}})})]})]},a.id)})})]})}),e.jsx(qe,{rowsPerPageOptions:[5],component:"div",count:ce,rowsPerPage:n.size,page:n.page,onPageChange:de,onRowsPerPageChange:ge}),e.jsxs(Y,{open:te,onClose:W,"aria-labelledby":"alert-dialog-title","aria-describedby":"alert-dialog-description",children:[e.jsx(X,{id:"alert-dialog-title",children:"Xác nhận thay đổi trạng thái"}),e.jsx(q,{children:e.jsxs(v,{children:["Bạn có chắc chắn muốn ",w===0?"xóa":"khôi phục"," nhân viên này không?"]})}),e.jsxs(J,{children:[e.jsx(x,{onClick:W,color:"primary",children:"Hủy"}),e.jsx(x,{onClick:je,color:"secondary",autoFocus:!0,children:w===0?"Xóa":"Khôi phục"})]})]}),e.jsxs(Y,{open:oe,onClose:B,children:[e.jsx(X,{children:"Xác nhận cấp lại mật khẩu"}),e.jsx(q,{children:T?e.jsxs(v,{children:["Bạn có chắc chắn muốn cấp lại mật khẩu cho nhân viên ",e.jsx("strong",{children:T})," không?"]}):e.jsx(v,{color:"error",children:"Không thể lấy thông tin email của nhân viên. Vui lòng kiểm tra lại dữ liệu."})}),e.jsxs(J,{children:[e.jsx(x,{onClick:B,children:"Hủy"}),e.jsx(x,{onClick:()=>ke(T),children:"Xác nhận"})]})]}),e.jsx(Je,{open:m.open,autoHideDuration:6e3,onClose:L,anchorOrigin:{vertical:"top",horizontal:"right"},children:e.jsx(Fe,{onClose:L,severity:m.severity,sx:{width:"100%"},children:m.message})})]})};export{Ta as default};

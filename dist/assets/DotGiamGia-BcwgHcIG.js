import{z as ce,E as de,j as e,r as n,b as he,B as T,G as i,k as h,f as v,I as ge,p as ue,m as xe,h as g,d as me,i as u,A as je}from"./index-C3AKKGhn.js";import{d as pe}from"./Add-B5eb1IN-.js";import{d as fe}from"./Visibility-iw0o22V7.js";import{d as Ce,a as be,b as Se}from"./DeleteSweep-BqnyH-1O.js";import{l as ye,d as Te,s as ve,b as De}from"./dotGiamGiaService-CxhqTxP5.js";import{M as x}from"./MenuItem-BPROy0V0.js";import{F as ke}from"./Fab-B8uBxqEe.js";import{T as we,a as Pe,b as Ie,c as D,d as Ge}from"./TableRow-B_CqS-KR.js";import{T as t}from"./TableCell-H1HogFdd.js";import{T as k}from"./Tooltip-y754dXzM.js";import{S as Re}from"./Switch-DQniZdEO.js";import{T as Be}from"./TablePagination-BljFDuGW.js";import{D as M,a as O,b as _,c as E}from"./DialogTitle--OzXCsew.js";import{D as H}from"./DialogContentText-ByK0d3GZ.js";import{S as Fe}from"./Snackbar-Dfcu8d7G.js";import"./SwitchBase-BbMjoehg.js";import"./KeyboardArrowRight-CMlb_Nei.js";import"./LastPage-BFOqoU3v.js";var w={},Me=de;Object.defineProperty(w,"__esModule",{value:!0});var W=w.default=void 0,Oe=Me(ce()),_e=e;W=w.default=(0,Oe.default)((0,_e.jsx)("path",{d:"M15.5 14h-.79l-.28-.27C15.41 12.59 16 11.11 16 9.5 16 5.91 13.09 3 9.5 3S3 5.91 3 9.5 5.91 16 9.5 16c1.61 0 3.09-.59 4.23-1.57l.27.28v.79l5 4.99L20.49 19zm-6 0C7.01 14 5 11.99 5 9.5S7.01 5 9.5 5 14 7.01 14 9.5 11.99 14 9.5 14"}),"Search");function aa(){const[m,P]=n.useState(1),[K,A]=n.useState(0),[I,N]=n.useState([]),[s,G]=n.useState({tenOrMa:"",giaTri:"",trangThai:"",ngayBatDau:"",ngayKetThuc:"",size:5}),[o,$]=n.useState(5),[z,j]=n.useState(!1),[L,l]=n.useState(""),[X,p]=n.useState("success"),[q,f]=n.useState(!1),[V,C]=n.useState(!1),[b,S]=n.useState(null),[J,Q]=n.useState(null),y=he(),c=async()=>{try{const a=await ye({...s,size:o,page:m-1});N(a.data.content),A(a.data.totalPages)}catch(a){console.error("Error fetching coupons:",a)}};n.useEffect(()=>{const a=setInterval(()=>{c()},2e3);return()=>clearInterval(a)},[]),n.useEffect(()=>{c()},[m,o,s]);const d=a=>{G({...s,[a.target.name]:a.target.value})},U=(a,r)=>{P(r+1)},Y=a=>{$(parseInt(a.target.value,10)),P(1)},Z=a=>{y(`/dotgiamgia/cauhinhdotgiamgia/view/${a}`)},ee=a=>{y(`/dotgiamgia/cauhinhdotgiamgia/edit/${a}`)},ae=a=>{S(a),f(!0)},R=()=>{f(!1)},te=()=>{y("/dotgiamgia/cauhinhdotgiamgia")},ne=async()=>{await Te(b),f(!1),c(),l("Hủy đợt giảm giá thành công"),p("success"),j(!0)},B=()=>{C(!1),S(null)},re=(a,r)=>{S(a),Q(r),C(!0)},se=async()=>{const a=J===1?1:4;try{if(a===4)if((await ve(b)).status===200)l("Phiếu giảm giá đã được bắt đầu áp dụng.");else throw new Error("Có lỗi xảy ra khi bắt đầu áp dụng phiếu giảm giá.");else if(a===1)if((await De(b)).status===200)l("Phiếu giảm giá đã được ngừng áp dụng.");else throw new Error("Có lỗi xảy ra khi ngừng áp dụng phiếu giảm giá.");p("success"),c()}catch(r){console.error(r),l(r.message||"Cập nhật trạng thái thất bại."),p("error")}finally{j(!0),C(!1)}},F=()=>{j(!1)},ie=a=>{switch(a){case 0:return"gray";case 1:return"green";case 2:return"red";case 3:return"#FFA500";case 4:return"black";default:return"blue"}},oe=a=>{switch(a){case 0:return"Sắp Diễn Ra";case 1:return"Đang Diễn Ra";case 2:return"Đã Diễn Ra";case 3:return"Đã Hủy";case 4:return"Đang tạm dừng";default:return"Không xác định"}},le=()=>{G({tenOrMa:"",ngayBatDau:"",ngayKetThuc:"",trangThai:""})};return e.jsxs("div",{children:[e.jsx(T,{sx:{backgroundColor:"#f0f0f0",p:2,borderRadius:2,marginBottom:2},children:e.jsxs(T,{sx:{backgroundColor:"white",p:2,borderRadius:2},children:[e.jsxs(i,{container:!0,spacing:3,alignItems:"center",p:2,children:[e.jsx(i,{item:!0,xs:12,sm:3,children:e.jsx(h,{fullWidth:!0,variant:"outlined",children:e.jsx(v,{name:"tenOrMa",label:"Tên hoặc Mã",value:s.tenOrMa,onChange:d,variant:"outlined",InputProps:{startAdornment:e.jsx(ge,{position:"start",children:e.jsx(W,{})})},fullWidth:!0})})}),e.jsx(i,{item:!0,xs:12,sm:2,children:e.jsx(h,{fullWidth:!0,variant:"outlined",children:e.jsx(v,{name:"ngayBatDau",type:"datetime-local",label:"Ngày Bắt Đầu",InputLabelProps:{shrink:!0},value:s.ngayBatDau,onChange:d,fullWidth:!0})})}),e.jsx(i,{item:!0,xs:12,sm:2,children:e.jsx(h,{fullWidth:!0,variant:"outlined",children:e.jsx(v,{name:"ngayKetThuc",type:"datetime-local",label:"Ngày Kết Thúc",InputLabelProps:{shrink:!0},value:s.ngayKetThuc,onChange:d,fullWidth:!0})})}),e.jsx(i,{item:!0,xs:12,sm:2,children:e.jsxs(h,{fullWidth:!0,variant:"outlined",children:[e.jsx(ue,{children:"Trạng Thái"}),e.jsxs(xe,{name:"trangThai",value:s.trangThai,onChange:d,fullWidth:!0,label:"Trạng Thái",children:[e.jsx(x,{value:"",children:"Tất cả"}),e.jsx(x,{value:"0",children:"Sắp Diễn Ra"}),e.jsx(x,{value:"1",children:"Đang Diễn Ra"}),e.jsx(x,{value:"2",children:"Đã Diễn Ra"})]})]})}),e.jsx(i,{item:!0,xs:12,sm:2,children:e.jsx(g,{onClick:le,color:"secondary",sx:{border:"1px solid",borderRadius:2,padding:1,backgroundColor:"#f5f5f5",transition:"background-color 0.3s ease, box-shadow 0.3s ease",boxShadow:"0 4px 8px rgba(0, 0, 0, 0.1)","&:hover":{backgroundColor:"#e0e0e0",boxShadow:"0 6px 12px rgba(0, 0, 0, 0.15)"},"& .MuiSvgIcon-root":{transition:"transform 0.3s ease"},"&:hover .MuiSvgIcon-root":{transform:"rotate(360deg)"}},children:e.jsx(Ce,{})})})]}),e.jsx(ke,{color:"primary","aria-label":"add",sx:{position:"fixed",top:340,right:16,boxShadow:3},onClick:te,children:e.jsx(pe,{})})]})}),e.jsx(we,{component:me,children:e.jsxs(Pe,{children:[e.jsx(Ie,{children:e.jsxs(D,{children:[e.jsx(t,{children:"STT"}),e.jsx(t,{children:"Mã đợt giảm giá"}),e.jsx(t,{children:"Tên đợt giảm giá"}),e.jsx(t,{children:"Ngày bắt đầu"}),e.jsx(t,{children:"Ngày kết thúc"}),e.jsx(t,{children:"Trạng thái"}),e.jsx(t,{children:"Chi tiết"}),e.jsx(t,{children:"Hành động"})]})}),e.jsx(Ge,{children:I.length>0?I.map((a,r)=>e.jsxs(D,{children:[e.jsx(t,{children:r+1}),e.jsx(t,{children:a.ma}),e.jsx(t,{children:a.ten}),e.jsx(t,{children:a.thoiGianBatDau}),e.jsx(t,{children:a.thoiGianKetthuc}),e.jsx(t,{children:e.jsx(T,{sx:{backgroundColor:ie(a.trangThai),color:"white",padding:"5px 10px",borderRadius:"8px",textAlign:"center",width:"120px",fontWeight:"bold"},children:oe(a.trangThai)})}),e.jsx(t,{children:e.jsx(k,{title:"Xem chi tiết",children:e.jsx(g,{onClick:()=>Z(a.id),children:e.jsx(fe,{})})})}),e.jsxs(t,{children:[(a.trangThai===0||a.trangThai===4)&&e.jsx(e.Fragment,{children:e.jsx(g,{color:"secondary",onClick:()=>ee(a.id),children:e.jsx(k,{title:"Chỉnh sửa",children:e.jsx(be,{})})})}),(a.trangThai===0||a.trangThai===1||a.trangThai===4)&&e.jsx(e.Fragment,{children:e.jsx(k,{title:"Hủy đợt giảm giá",children:e.jsx(g,{color:"error",onClick:()=>ae(a.id),children:e.jsx(Se,{})})})}),(a.trangThai===1||a.trangThai===4)&&e.jsx(e.Fragment,{children:e.jsx(Re,{checked:a.trangThai===1,onChange:()=>re(a.id,a.trangThai)})})]})]},a.id)):e.jsx(D,{children:e.jsx(t,{colSpan:7,align:"center",children:"Không có phiếu giảm giá nào"})})})]})}),e.jsx(Be,{rowsPerPageOptions:[5,10,25],component:"div",count:K*o,page:m-1,onPageChange:U,rowsPerPage:o,onRowsPerPageChange:Y}),e.jsxs(M,{open:q,onClose:R,children:[e.jsx(O,{children:"Xác nhận hủy phiếu"}),e.jsx(_,{children:e.jsx(H,{children:"Bạn có chắc chắn muốn hủy phiếu này? Hành động này không thể hoàn tác."})}),e.jsxs(E,{children:[e.jsx(u,{onClick:R,color:"primary",children:"Hủy bỏ"}),e.jsx(u,{onClick:ne,color:"secondary",autoFocus:!0,children:"Xác nhận"})]})]}),e.jsxs(M,{open:V,onClose:B,"aria-labelledby":"alert-dialog-title","aria-describedby":"alert-dialog-description",children:[e.jsx(O,{id:"alert-dialog-title",children:"Xác nhận thay đổi trạng thái?"}),e.jsx(_,{children:e.jsx(H,{id:"alert-dialog-description",children:"Bạn có chắc chắn muốn thay đổi trạng thái của đợt giảm giá này không?"})}),e.jsxs(E,{children:[e.jsx(u,{onClick:B,children:"Hủy"}),e.jsx(u,{onClick:se,autoFocus:!0,children:"Đồng ý"})]})]}),e.jsx(Fe,{open:z,autoHideDuration:3e3,onClose:F,anchorOrigin:{vertical:"top",horizontal:"center"},children:e.jsx(je,{onClose:F,severity:X,variant:"filled",children:L})})]})}export{aa as default};

import{r as c,j as e,h as B,aq as R,ar as N,as as A,B as I,f as P,i as C,M as D,d as H,k as M,p as W,m as O,c as F}from"./index-C3AKKGhn.js";import{b as V}from"./back-end-vuWvP0DO.js";import{I as U,u as z,a as $,c as L,f as X}from"./webcam-298VT8Rq.js";import{B as v}from"./react-toastify.esm-BgZIXYS1.js";import{N as k}from"./notification-B40vY8uZ.js";import{E as q}from"./Edit-BdLQoyQM.js";import{A as K}from"./Add-CIMKSK4g.js";import{M as S}from"./MenuItem-BPROy0V0.js";import{T as J,a as Q,b as Y,c as E,d as Z}from"./TableRow-B_CqS-KR.js";import{T}from"./TableCell-H1HogFdd.js";import{S as G}from"./Switch-DQniZdEO.js";import{T as _}from"./TablePagination-BljFDuGW.js";import"./SwitchBase-BbMjoehg.js";import"./KeyboardArrowRight-CMlb_Nei.js";import"./LastPage-BFOqoU3v.js";const ee={position:"absolute",top:"40%",left:"50%",transform:"translate(-50%, -50%)",width:800,bgcolor:"background.paper",border:"2px solid #673AB7",borderRadius:"10px",p:5};function ae({fetchRams:j,info:s}){const[g,p]=c.useState(!1),f=()=>p(!0),n=()=>{y(),p(!1)},[i,o]=c.useState({ten:"",doPhanGiai:"",trangThai:1}),[l,x]=c.useState({ten:"",doPhanGiai:"",trangThai:1});c.useEffect(()=>{s&&g&&o({ten:s.ten,doPhanGiai:s.doPhanGiai,trangThai:1})},[s,g]);const u=r=>{const{value:a,name:t}=r.target;o({...i,[t]:a}),x({...l,[t]:a?"":"Trường này không được để trống"})},y=()=>{o({ten:"",doPhanGiai:"",trangThai:1}),x({ten:"",doPhanGiai:"",trangThai:1})},h=async()=>{let r=!0;const a={...l};for(const m in i)i[m]||(a[m]="Trường này không được để trống",r=!1);x(a);const t=await U(i.ten,s.id);t||(r=!1,console.log("checkName: ",t),alert("Tên đã tồn tại")),r&&(await z({id:s.id,doPhanGiai:i.doPhanGiai,ten:i.ten,trangThai:i.trangThai})?(v.success(k.CREATED),j(),n()):v.error(k.ERROR))};return e.jsxs("div",{children:[e.jsx(B,{sx:{color:"#6C6C6C"},onClick:f,children:e.jsx(q,{})}),e.jsx(R,{"aria-labelledby":"transition-modal-title","aria-describedby":"transition-modal-description",open:g,onClose:n,closeAfterTransition:!0,slots:{backdrop:N},slotProps:{backdrop:{timeout:500}},children:e.jsx(A,{in:g,children:e.jsxs(I,{sx:ee,children:[e.jsxs("div",{style:{display:"flex",flexDirection:"column",gap:"40px",textAlign:"center"},children:[e.jsx("h2",{style:{fontSize:"30px"},children:"CHỈNH SỬA"}),e.jsx(P,{label:"Tên Webcam",style:{width:"100%"},name:"ten",error:!!l.ten,helperText:l.ten,onChange:u,value:i.ten}),e.jsx(P,{label:"Độ phân giải",style:{width:"100%"},name:"doPhanGiai",error:!!l.doPhanGiai,helperText:l.doPhanGiai,onChange:u,value:i.doPhanGiai})]}),e.jsxs("div",{style:{display:"flex",justifyContent:"space-between"},children:[e.jsxs("div",{style:{marginTop:"10px",fontStyle:"italic",color:"gray"},children:[e.jsxs("p",{children:["Ngày tạo: ",s.ngayTao]}),e.jsxs("p",{children:["Người tạo: ",s.nguoiTao]}),e.jsxs("p",{children:["Ngày sửa: ",s.ngaySua]}),e.jsxs("p",{children:["Người sửa: ",s.nguoiSua]})]}),e.jsxs("div",{style:{display:"flex",justifyContent:"end",alignItems:"end",marginTop:"20px",gap:"10px"},children:[e.jsx(C,{variant:"contained",color:"secondary",onClick:n,children:"Hủy"}),e.jsx(C,{variant:"contained",color:"secondary",onClick:h,children:"Xác Nhận"})]})]})]})})})]})}const te={position:"absolute",top:"40%",left:"50%",transform:"translate(-50%, -50%)",width:800,bgcolor:"background.paper",border:"2px solid #673AB7",borderRadius:"10px",p:5};function ne({fetchRams:j}){const[s,g]=c.useState(!1),p=()=>g(!0),f=()=>{u(),g(!1)},[n,i]=c.useState({ten:"",doPhanGiai:"",trangThai:1}),[o,l]=c.useState({ten:"",doPhanGiai:"",trangThai:1}),x=h=>{const{value:r,name:a}=h.target;i({...n,[a]:r}),l({...o,[a]:r?"":"Trường này không được để trống"})},u=()=>{i({ten:"",doPhanGiai:"",trangThai:1}),l({ten:"",doPhanGiai:"",trangThai:1})},y=async()=>{let h=!0;const r={...o};for(const t in n)n[t]||(r[t]="Trường này không được để trống",h=!1);l(r);const a=await $(n.ten);a||(h=!1,console.log("checkName: ",a),alert("Tên đã tồn tại")),h&&(await L({ten:n.ten,doPhanGiai:n.doPhanGiai,trangThai:n.trangThai})?(v.success(k.CREATED),j(),f()):v.error(k.ERROR))};return e.jsxs("div",{children:[e.jsx(C,{variant:"contained",color:"secondary",endIcon:e.jsx(K,{}),onClick:p,children:"Tạo mới"}),e.jsx(R,{"aria-labelledby":"transition-modal-title","aria-describedby":"transition-modal-description",open:s,onClose:f,closeAfterTransition:!0,slots:{backdrop:N},slotProps:{backdrop:{timeout:500}},children:e.jsx(A,{in:s,children:e.jsxs(I,{sx:te,children:[e.jsxs("div",{style:{display:"flex",flexDirection:"column",gap:"40px",textAlign:"center"},children:[e.jsx("h2",{style:{fontSize:"30px"},children:"THÊM WEBCAM"}),e.jsx(P,{label:"Tên WEBCAM",style:{width:"100%"},name:"ten",error:!!o.ten,helperText:o.ten,onChange:x}),e.jsx(P,{label:"Độ Phân Giải",style:{width:"100%"},name:"doPhanGiai",error:!!o.doPhanGiai,helperText:o.doPhanGiai,onChange:x})]}),e.jsxs("div",{style:{display:"flex",justifyContent:"end",alignItems:"end",marginTop:"20px",gap:"10px"},children:[e.jsx(C,{variant:"contained",color:"secondary",onClick:f,children:"Hủy"}),e.jsx(C,{variant:"contained",color:"secondary",onClick:y,children:"Xác Nhận"})]})]})})})]})}const Te=()=>{const j=[{id:"ma",label:"Mã",minWidth:70},{id:"ten",label:"Tên",minWidth:300},{id:"doPhanGiai",label:"Độ phân giải",minWidth:120},{id:"trangThai",label:"Trạng thái",minWidth:80},{id:"hanhDong",label:"Hành động",minWidth:170}],[s,g]=c.useState({pageNo:"",pageSize:"",totalPage:"",totalElement:""}),[p,f]=c.useState([]);c.useEffect(()=>{console.log("data: ",p)},[p]);const[n,i]=c.useState({page:"0",size:"5",name:"",trangThai:""});c.useEffect(()=>{console.log("filter: ",n),o()},[n]);const o=async()=>{const a=await X(n);f(a.data.data),g(t=>({...t,pageNo:a.data.pageNo,pageSize:a.data.pageSize,totalPage:a.data.totalPage,totalElement:a.data.totalElement}))},l=a=>{i(t=>({...t,page:0,size:5,name:a.target.value}))},x=a=>{i(t=>({...t,page:0,size:5,trangThai:a.target.value}))},u=(a,t)=>{console.log("newPage: ",t),i(m=>({...m,page:t}))},y=a=>{i(t=>({...t,size:a.target.value}))},h=a=>t=>{t.target.checked?r(a,1):r(a,0)},r=async(a,t)=>{let d=(await F.get(`${V}/webcam/detail/${a}`)).data.data;console.log("temp: ",d);let b={...d,trangThai:t};console.log("temp1: ",b),await z(b),o()};return e.jsx("div",{children:e.jsx(D,{children:e.jsxs(H,{sx:{width:"100%",overflow:"hidden"},children:[e.jsxs("div",{style:{display:"flex",justifyContent:"space-between",paddingTop:"10px"},children:[e.jsxs("div",{children:[e.jsx(P,{sx:{width:"400px"},color:"secondary",onChange:l,id:"outlined-basic",label:"Tìm theo tên",variant:"outlined"}),e.jsxs(M,{sx:{width:"200px",marginLeft:"20px"},children:[e.jsx(W,{id:"demo-simple-select-label",children:"Trạng Thái"}),e.jsxs(O,{labelId:"demo-simple-select-label",id:"demo-simple-select",value:n.trangThai,label:"Trạng thái",onChange:x,children:[e.jsx(S,{value:"",children:"Tất cả"}),e.jsx(S,{value:1,children:"Hoạt động"}),e.jsx(S,{value:0,children:"Không hoạt động"})]})]})]}),e.jsx("div",{children:e.jsx(ne,{fetchRams:o})})]}),e.jsx(J,{sx:{maxHeight:440},children:e.jsxs(Q,{stickyHeader:!0,"aria-label":"sticky table",children:[e.jsx(Y,{children:e.jsxs(E,{children:[e.jsx(T,{children:"STT"}),j.map(a=>e.jsx(T,{align:a.align,style:{minWidth:a.minWidth},children:a.label},a.id))]})}),e.jsx(Z,{children:p.map((a,t)=>{const m=n.page*n.size+t+1;return e.jsxs(E,{hover:!0,role:"checkbox",tabIndex:-1,children:[e.jsx(T,{align:"left",children:m}),j.map(d=>{const b=a[d.id];if(d.id==="trangThai")return e.jsx(T,{align:d.align,children:b===1?"Hoạt động":"Đã tắt"},d.id);if(d.id==="hanhDong"){let w=a.trangThai;return e.jsx("div",{style:{display:"flex"},children:e.jsxs(T,{sx:{display:"flex"},align:d.align,children:[e.jsx(ae,{fetchRams:o,info:a}),w===1&&e.jsx(G,{defaultChecked:!0,color:"secondary",onChange:h(a.id)}),w===0&&e.jsx(G,{color:"secondary",onChange:h(a.id)})]},d.id)})}return e.jsx(T,{align:d.align,children:b},d.id)})]},a.code)})})]})}),e.jsx(_,{rowsPerPageOptions:[5,10,25,50,100],component:"div",count:s.totalElement,rowsPerPage:n.size,page:n.page,onPageChange:u,onRowsPerPageChange:y})]})})})};export{Te as default};

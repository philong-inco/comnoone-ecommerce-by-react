import{q as tt,j as e,c as m,ab as Gt,ac as Lt,ae as Mt,ad as Bt,a as Pe,b as Ft,r as a,M as Wt,d as L,f as pe,n as zt,R as $t,i as Ze,k as et,m as w,e as at,G as ue,T as Ae,E as K,D as Ut,h as ge}from"./index-DkjfH3Nj.js";import{g as Ne,a as Ie,b as Vt}from"./request-DcjhHzTt.js";import{d as Yt,S as f,B as st}from"./ImportProduct-DAjh42MA.js";import{T as J,a as Z,b as ee,c as b,d as te}from"./TableRow-DrBFg2V4.js";import{T as i}from"./TableCell-BUbxn9S2.js";import{D as me,a as xe,b as _e,c as Oe}from"./DialogTitle-AfTjaLGA.js";import{C as nt}from"./Checkbox-CJjLKa6W.js";import{P as it}from"./Pagination-BgvdVt-w.js";import{S as Re,A as Ee}from"./Snackbar-BAUbN_1o.js";import{a as qt,G as Qt}from"./index-DPnwyd78.js";import{e as Xt}from"./billService-LSyzHNP3.js";import{g as Kt}from"./couponsService-D4rGWuAg.js";const Jt=tt(e.jsx("path",{d:"M13 7h-2v4H7v2h4v4h2v-4h4v-2h-4zm-1-5C6.48 2 2 6.48 2 12s4.48 10 10 10 10-4.48 10-10S17.52 2 12 2m0 18c-4.41 0-8-3.59-8-8s3.59-8 8-8 8 3.59 8 8-3.59 8-8 8"}),"AddCircleOutline"),Zt=tt(e.jsx("path",{d:"M7 11v2h10v-2zm5-9C6.48 2 2 6.48 2 12s4.48 10 10 10 10-4.48 10-10S17.52 2 12 2m0 18c-4.41 0-8-3.59-8-8s3.59-8 8-8 8 3.59 8 8-3.59 8-8 8"}),"RemoveCircleOutline"),xa=async()=>{try{return(await m.get("https://online-gateway.ghn.vn/shiip/public-api/master-data/province",{headers:{token:"0292ba75-34b6-11ef-89ca-1aad91406dac"}})).data}catch(l){throw console.error("Error fetching provinces:",l),l}},Sa=async l=>{try{return(await m.get("https://online-gateway.ghn.vn/shiip/public-api/master-data/district",{headers:{token:"0292ba75-34b6-11ef-89ca-1aad91406dac"},params:{province_id:l}})).data}catch(r){throw console.error("Error fetching districts:",r),r}},ja=async l=>{try{return(await m.get("https://online-gateway.ghn.vn/shiip/public-api/master-data/ward",{headers:{token:"0292ba75-34b6-11ef-89ca-1aad91406dac"},params:{district_id:l}})).data}catch(r){throw console.error("Error fetching wards:",r),r}},fa=async(l,r)=>{try{return(await m.get("https://online-gateway.ghn.vn/shiip/public-api/v2/shipping-order/leadtime",{headers:{token:"d73043b1-2777-11ee-b394-8ac29577e80e",shop_id:"4374133"},params:{from_district_id:1485,from_ward_code:"1A0607",to_district_id:l,to_ward_code:r,service_id:53320}})).data}catch(c){throw console.error("Error fetching shipping lead time:",c),c}},ba=async(l,r)=>{try{return(await m.get("https://online-gateway.ghn.vn/shiip/public-api/v2/shipping-order/fee",{headers:{token:"d73043b1-2777-11ee-b394-8ac29577e80e",shop_id:"4374133"},params:{service_type_id:2,insurance_value:"",coupon:"",from_district_id:1485,to_district_id:l,to_ward_code:r,height:15,length:15,weight:1e3,width:15}})).data}catch(c){throw console.error("Error fetching shipping fee:",c),c}},rt=async(l,r,c,o)=>{try{return await Ne(`serial-number/product-detail-code-serial/${l}?size=${o}&page=${c}&codeSerial=${r}`)}catch(j){throw console.error("Error fetching serial number by product id :",j),j}},lt=async l=>{try{return await Ie("serial-number-sold",l)}catch(r){throw console.error("Error create all:",r),r}},ot=async l=>{try{return await Ne(`serial-number-sold?code=${l}`)}catch(r){throw console.error("Error get all:",r),r}},ea=async(l,r)=>{try{return await Ie("serial-number-sold/delete",{billCode:l,serialNumberIds:r})}catch(c){throw console.error("Error del all:",c),c}},ct=l=>{switch(l){case 0:return Bt[500];case 1:return Mt[200];case 2:return Lt[500];default:return Gt[400]}},ta=l=>{const{id:r}=Pe(),{onLoading:c}=l;Ft();const[o,j]=a.useState("0"),I=t=>{const n=t.target.value;j(n),n==="0"?u(g=>({...g,tenSP:C.ma,ma:""})):n==="1"&&u(g=>({...g,ma:C.tenSP,tenSP:""}))},[_,D]=a.useState(0),H=()=>{ie([]),re([]),ht([]),G([]),he([]),s([]),Me([]),ze([]),x([]),Fe([]),N([]),oe([]),j("0"),u(t=>({...t,tenSP:"",ma:""})),D(t=>t+1)},v="http://localhost:8080/api/san-pham-chi-tiet/find/filter?",[O,T]=a.useState([]),[C,u]=a.useState({tenSP:"",maSP:"",maSPCT:"",ngayTaoTruoc:"",ngayTaoSau:"",ngaySuaTruoc:"",ngaySuaSau:"",trangThai:"",nhuCau:"",thuongHieu:"",ram:"",mauSac:"",cpu:"",vga:"",webcam:"",oCung:"",manHinh:"",heDieuHanh:"",banPhim:""}),[A,M]=a.useState([]),[R,h]=a.useState([]),[y,Se]=a.useState([]),[ae,je]=a.useState([]),[fe,B]=a.useState([]),[F,W]=a.useState([]),[E,z]=a.useState([]),[Ge,be]=a.useState([]),[Ce,se]=a.useState([]),[$,P]=a.useState([]),[ye,U]=a.useState([]);a.useState([{id:1,ten:"Hoạt động"},{id:0,ten:"Đã tắt"}]);const[ne,ie]=a.useState([]),[V,re]=a.useState([]),[Y,G]=a.useState([]),[le,oe]=a.useState([]),[ce,he]=a.useState([]),[q,s]=a.useState([]),[d,x]=a.useState([]),[k,N]=a.useState([]),[Le,Me]=a.useState([]),[Be,Fe]=a.useState([]),[We,ze]=a.useState([]),[$e,ht]=a.useState([]),[dt,Te]=a.useState(!1),[de,Q]=a.useState([]),[ut,Ue]=a.useState([]),[gt,pt]=a.useState([]),[ke,we]=a.useState(null),[Ve,X]=a.useState(1),[De,aa]=a.useState(5),[mt,xt]=a.useState(0),[Ye,He]=a.useState(""),[St,jt]=a.useState(""),[ft,bt]=a.useState("success"),[Ct,qe]=a.useState(!1),Qe=()=>{He(""),Te(!1),Q([]),Ue([]),X(1),we(null)},yt=async()=>{const t=await ot(r);if(t.status_code===200){const n=t.data.flatMap(g=>g.serialNumbers.map(p=>p.serialNumberId));Ue(n),Q(n)}},Tt=t=>{we(t),yt(),ve(t,Ye,Ve,5),Te(!0)},ve=async(t,n,g,p)=>{const S=await rt(t,n||"",g-1,p);S.status_code===200&&(pt(S.data.result),xt(S.data.meta.total),X(S.data.meta.page+1))},kt=t=>{Q(de),X(t),ve(ke,Ye,t,De)},wt=t=>{const n=t.target.value;He(n.trim()),X(1),ve(ke,n,1,De)},Dt=async()=>{const t={billCode:r,listSerialNumberId:de,productId:ke};console.log("DATA REQUEST : ",t),(await lt(t)).status_code===201&&(jt("Cập nhập số lượng thành công"),bt("success"),qe(!0),Te(!1),Q([]),He(""),X(1),we(null),c())},Ht=t=>{Q(n=>n.includes(t)?n.filter(g=>g!==t):[...n,t])};a.useEffect(()=>{Xe(),Pt()},[]),a.useEffect(()=>{const t=$e.join(",");u(n=>({...n,trangThai:t}))},[$e]),a.useEffect(()=>{const t=ne.join(",");u(n=>({...n,nhuCau:t}))},[ne]),a.useEffect(()=>{const t=V.join(",");u(n=>({...n,thuongHieu:t}))},[V]),a.useEffect(()=>{const t=Y.join(",");u(n=>({...n,ram:t}))},[Y]),a.useEffect(()=>{const t=ce.join(",");u(n=>({...n,cpu:t}))},[ce]),a.useEffect(()=>{const t=q.join(",");u(n=>({...n,vga:t}))},[q]),a.useEffect(()=>{const t=We.join(",");u(n=>({...n,banPhim:t}))},[We]),a.useEffect(()=>{const t=Le.join(",");u(n=>({...n,manHinh:t}))},[Le]),a.useEffect(()=>{const t=d.join(",");u(n=>({...n,webcam:t}))},[d]),a.useEffect(()=>{const t=Be.join(",");u(n=>({...n,heDieuHanh:t}))},[Be]),a.useEffect(()=>{const t=le.join(",");u(n=>({...n,mauSac:t}))},[le]),a.useEffect(()=>{const t=k.join(",");u(n=>({...n,oCung:t}))},[k]);const vt=t=>{const n=t.target.value.toString().trim();o==="0"?u(g=>({...g,tenSP:n,maSP:""})):o==="1"&&u(g=>({...g,maSP:n,tenSP:""}))},[sa,At]=a.useState(0);a.useEffect(()=>{Xe()},[C]);const Xe=async()=>{const t=Object.entries(C).filter(([p,S])=>S!=="").map(([p,S])=>`${p}=${S}`).join("&"),n=v+t,g=await m.get(n);T(g.data.data),At(parseInt(g.data.totalElement))},Pt=async()=>{const t=await m.get("http://localhost:8080/api/nhu-cau/all-list"),n=await m.get("http://localhost:8080/api/thuong-hieu/all-list"),g=await m.get("http://localhost:8080/api/ram/all-list"),p=await m.get("http://localhost:8080/api/mau-sac/all-list"),S=await m.get("http://localhost:8080/api/cpu/all-list"),Nt=await m.get("http://localhost:8080/api/vga/all-list"),It=await m.get("http://localhost:8080/api/webcam/all-list"),_t=await m.get("http://localhost:8080/api/o-cung/all-list"),Ot=await m.get("http://localhost:8080/api/man-hinh/all-list"),Rt=await m.get("http://localhost:8080/api/he-dieu-hanh/all-list"),Et=await m.get("http://localhost:8080/api/ban-phim/all-list");M(t.data.data),h(n.data.data),Se(g.data.data),je(p.data.data),B(S.data.data),W(Nt.data.data),z(It.data.data),be(_t.data.data),se(Ot.data.data),P(Rt.data.data),U(Et.data.data)},Ke=[{id:"maSPCT",label:"Mã",minWidth:70},{id:"sanPham",label:"Tên",minWidth:150},{id:"giaBan",label:"Giá sản phẩm",minWidth:100,align:"left",format:t=>parseFloat(t||0).toLocaleString()},{id:"giaSauKhuyenMai",label:"Giá bán",minWidth:100,align:"left",format:t=>parseFloat(t||0).toLocaleString()},{id:"soTienDuocGiam",label:"Số tiền được giảm",minWidth:100,align:"left"},{id:"hanhDong",label:"Hành động",minWidth:30,align:"center"}],Je=()=>{qe(!1)};return e.jsxs(e.Fragment,{children:[e.jsxs(Wt,{label:"Danh sách sản phẩm",children:[e.jsx("div",{children:e.jsxs(L,{children:[e.jsxs("div",{style:{display:"flex",padding:10,paddingTop:20},children:[e.jsx(pe,{sx:{maxHeight:"10px"},color:"secondary",onChange:vt,id:"outlined-basic",label:"Nhập từ khóa",variant:"outlined"}),e.jsx("div",{style:{marginLeft:10,display:"flex",alignItems:"center"},children:e.jsx(zt,{children:e.jsxs($t,{"aria-labelledby":"demo-controlled-radio-buttons-group",name:"controlled-radio-buttons-group",value:o,row:!0,onChange:I,children:[e.jsx(Ze,{value:"0",control:e.jsx(et,{color:"secondary",size:"small"}),label:"Tên"}),e.jsx(Ze,{value:"1",control:e.jsx(et,{color:"secondary",size:"small"}),label:"Mã"})]})})}),e.jsx("div",{onClick:H,style:{marginLeft:20,marginTop:10,marginRight:20},children:e.jsx(Yt,{color:"secondary",fontSize:"large"})})]}),e.jsxs("div",{style:{display:"flex",flexWrap:"wrap"},children:[e.jsx(f,{list:A,setListChecked:ie,nameDropDown:"Nhu cầu"}),e.jsx(f,{list:R,setListChecked:re,nameDropDown:"Thương hiệu"}),e.jsx(f,{list:y,setListChecked:G,nameDropDown:"RAM"}),e.jsx(f,{list:fe,setListChecked:he,nameDropDown:"CPU"}),e.jsx(f,{list:F,setListChecked:s,nameDropDown:"VGA"}),e.jsx(f,{list:Ce,setListChecked:Me,nameDropDown:"Màn hình"}),e.jsx(f,{list:ye,setListChecked:ze,nameDropDown:"Bàn phím"}),e.jsx(f,{list:Ge,setListChecked:N,nameDropDown:"Ổ cứng"}),e.jsx(f,{list:ae,setListChecked:oe,nameDropDown:"Màu sắc"}),e.jsx(f,{list:$,setListChecked:Fe,nameDropDown:"Hệ điều hành"}),e.jsx(f,{list:E,setListChecked:x,nameDropDown:"Webcam"})]})]})},_),e.jsx(L,{sx:{width:"100%",overflow:"hidden"},children:e.jsx(J,{sx:{maxHeight:440},children:e.jsxs(Z,{stickyHeader:!0,"aria-label":"sticky table",children:[e.jsx(ee,{children:e.jsxs(b,{children:[e.jsx(i,{style:{fontWeight:700},children:"STT"}),Ke.map(t=>e.jsx(i,{align:t.align,style:{minWidth:t.minWidth,fontWeight:700},children:t.label},t.id))]})}),e.jsx(te,{children:O.map((t,n)=>{const g=n+1;return e.jsxs(b,{hover:!0,role:"checkbox",tabIndex:-1,children:[e.jsx(i,{align:"center",children:g}),Ke.map(p=>{const S=t[p.id];return p.id==="hanhDong"?(t.trangThai,e.jsx(i,{align:p.align,children:e.jsx(w,{variant:"contained",color:"primary",onClick:()=>Tt(t.id),children:"Chọn serial"})},p.id)):e.jsx(i,{align:p.align,children:p.id==="sanPham"?e.jsx(e.Fragment,{children:`${t.tenSanPham} [ ${t.ram} - ${t.cpu} - ${t.ocung} -  ${t.mauSac} ]`}):p.format?e.jsx(e.Fragment,{children:e.jsxs("strong",{children:[e.jsxs("span",{style:{color:"red"},children:[p.format(S)," "]})," VNĐ"]})}):S},p.id)})]},t.id)})})]})})})]}),e.jsxs(me,{open:dt,onClose:Qe,PaperProps:{style:{width:"700px"}},children:[e.jsx(xe,{children:e.jsxs(st,{display:"flex",alignItems:"center",justifyContent:"space-between",children:[e.jsx("span",{style:{fontSize:"1.2rem",fontWeight:"bold"},children:"Danh sách serial"}),e.jsx(pe,{variant:"outlined",size:"small",label:"Tìm kiếm",style:{marginRight:"16px"},onChange:wt})]})}),e.jsxs(_e,{children:[e.jsx(J,{component:L,children:e.jsxs(Z,{children:[e.jsx(ee,{children:e.jsxs(b,{children:[e.jsx(i,{children:"Chọn"}),e.jsx(i,{children:"Mã"}),e.jsx(i,{children:"Trạng thái"})]})}),e.jsx(te,{children:gt.map(t=>e.jsxs(b,{children:[e.jsx(nt,{checked:de.includes(t.id),onChange:()=>Ht(t.id),disabled:t.trangThai===1&&!de.includes(t.id)&&!ut.includes(t.id)}),e.jsx(i,{children:t.ma}),e.jsx(i,{children:e.jsx(at,{label:t.trangThai==0?"Chưa bán":t.trangThai==1?"Đã bán":"Hủy",style:{backgroundColor:ct(t.trangThai),color:"#fff"},size:"small"})})]},t.id))})]})}),e.jsx(it,{sx:{marginTop:"10px",textAlign:"center"},count:Math.ceil(mt/De),page:Ve,onChange:(t,n)=>kt(n)})]}),e.jsxs(Oe,{children:[e.jsx(w,{onClick:Qe,children:"Hủy"}),e.jsx(w,{onClick:()=>{Dt()},variant:"contained",color:"primary",children:"Xác nhận"})]})]}),e.jsx(Re,{open:Ct,autoHideDuration:6e3,onClose:Je,anchorOrigin:{vertical:"top",horizontal:"right"},children:e.jsx(Ee,{onClose:Je,severity:ft,sx:{width:"100%"},children:St})})]})};function Ca(l){const{id:r}=Pe(),{onLoading:c,bill:o,title:j}=l,[I,_]=a.useState(!1),[D,H]=a.useState(!1),[v,O]=a.useState(""),[T,C]=a.useState("success"),[u,A]=a.useState(!1),[M,R]=a.useState([]),[h,y]=a.useState([]),[Se,ae]=a.useState([]),[je,fe]=a.useState([]),[B,F]=a.useState(null),[W,E]=a.useState(1),[z,Ge]=a.useState(5),[be,Ce]=a.useState(0),[se,$]=a.useState(""),P=async()=>{const s=await ot(r);if(s.status_code===200){R(s.data);const d=s.data.flatMap(x=>x.serialNumbers.map(k=>k.serialNumberId));ae(d),y(d)}},ye=async(s,d)=>{(await ea(s,d)).status_code===200&&(P(),c(),O("Xóa sản phẩm khỏi hóa đơn thành công"),C("success"),A(!0))};a.useEffect(()=>{P(),console.log("Vòa Load  ffff")},[o]);const U=async(s,d,x,k)=>{const N=await rt(s,d||"",x-1,k);N.status_code===200&&(fe(N.data.result),Ce(N.data.meta.total),E(N.data.meta.page+1))},ne=s=>{console.log("ID cần xóa",s);const d=s.serialNumbers.map(x=>x.serialNumberId);ye(r,d)},ie=async()=>{const s={billCode:r,listSerialNumberId:h,productId:B};console.log("DATA REQUEST : ",s),(await lt(s)).status_code===201&&(O("Cập nhập số lượng sản phẩm thành công"),C("success"),A(!0),H(!1),y([]),$(""),E(1),F(null),P(),c())},V=()=>{A(!1)},re=()=>{_(!I)},Y=()=>{_(!1)},G=s=>{F(s),P(),U(s,se,W,5),H(!0)};console.log("BILL IN SERIAL NUMBER SOLD : ",o);const le=s=>{y(h),E(s),U(B,se,s,z)},oe=s=>{const d=s.target.value;$(d.trim()),U(B,d,W,z)},ce=s=>{y(d=>d.includes(s)?d.filter(x=>x!==s):[...d,s])},he=()=>{P(),c()},q=()=>{$(""),H(!1),y([]),ae([]),E(1),F(null)};return console.log("Select ROW ",h),console.log("Select Dèauk ",h),e.jsxs(e.Fragment,{children:[e.jsxs(ue,{container:!0,spacing:2,padding:2,sx:{backgroundColor:"white",marginTop:2,borderRadius:4},children:[e.jsx(ue,{container:!0,spacing:2,children:e.jsxs(ue,{item:!0,xs:12,container:!0,justifyContent:"space-between",alignItems:"center",children:[e.jsx(Ae,{variant:"h3",children:j}),e.jsx(K,{title:"Thêm sản phẩm",placement:"top",children:e.jsx(w,{hidden:o.trangThai=="DANG_GIAO"||o.trangThai=="HOAN_THANH"||o.trangThai=="CHO_GIAO"||o.trangThai=="HUY",variant:"contained",color:"warning",onClick:re,disabled:!r,children:"Thêm sản phẩm"})})]})}),e.jsx(Ut,{sx:{marginY:2}}),e.jsx(J,{component:L,sx:{width:"100%"},children:e.jsxs(Z,{"aria-label":"simple table",children:[e.jsx(ee,{children:e.jsxs(b,{children:[e.jsx(i,{children:"STT"}),e.jsx(i,{children:"Ảnh"}),e.jsx(i,{children:"Mã SP"}),e.jsx(i,{children:"Tên sản phẩm"}),e.jsx(i,{children:"Số lượng"}),e.jsx(i,{children:"Thành tiền"}),e.jsx(i,{children:"Serial"}),e.jsx(i,{children:"Hành động"})]})}),e.jsx(te,{children:M.map((s,d)=>e.jsxs(b,{children:[e.jsx(i,{children:d+1}),e.jsx(i,{children:e.jsx("img",{src:"https://via.placeholder.com/50",alt:"Product",width:"50"})}),e.jsx(i,{children:s.productDetailCode}),e.jsxs(i,{children:[s.productName," ",e.jsx("br",{}),e.jsxs("strong",{style:{color:"red"},children:[parseFloat(s.price).toLocaleString()," VNĐ"]})]}),e.jsx(i,{children:e.jsxs("div",{style:{display:"flex",alignItems:"center"},children:[e.jsx(K,{title:"Cập nhập số lượng",placement:"top",children:e.jsx(ge,{disabled:o.trangThai=="DANG_GIAO"||o.trangThai=="HOAN_THANH"||o.trangThai=="CHO_GIAO"||o.trangThai=="HUY",onClick:()=>G(s.productDetailId),children:e.jsx(Zt,{})})}),e.jsx(pe,{disabled:o.trangThai=="DANG_GIAO"||o.trangThai=="HOAN_THANH"||o.trangThai=="CHO_GIAO"||o.trangThai=="HUY",type:"number",value:s.quantity,onChange:x=>G(s.productDetailId),inputProps:{min:0},sx:{width:50,height:30,"& .MuiInputBase-input":{padding:"5px 10px"}}}),e.jsx(K,{title:"Cập nhập số lượng",placement:"top",children:e.jsx(ge,{disabled:o.trangThai=="DANG_GIAO"||o.trangThai=="HOAN_THANH"||o.trangThai=="CHO_GIAO"||o.trangThai=="HUY",onClick:()=>G(s.productDetailId),children:e.jsx(Jt,{})})})]})}),e.jsx(i,{children:e.jsxs("strong",{style:{color:"red"},children:[parseFloat(s.quantity*s.price).toLocaleString()," VNĐ"]})}),e.jsx(i,{children:e.jsx("strong",{children:s.serialNumbers.map((x,k)=>e.jsxs("span",{children:[x.serialNumberCode,k<s.serialNumbers.length-1&&", "]},x.serialNumberId))})}),e.jsx(i,{children:e.jsx(K,{title:"Hủy toàn bộ sản phẩm : "+s.productName,placement:"top",children:e.jsx(ge,{disabled:o.trangThai=="DANG_GIAO"||o.trangThai=="HOAN_THANH"||o.trangThai=="CHO_GIAO"||o.trangThai=="HUY",onClick:()=>ne(s),style:{color:"red"},children:e.jsx(qt,{})})})})]},s.id))})]})}),e.jsx(ue,{container:!0,justifyContent:"end",alignItems:"center",mt:2,children:e.jsxs(Ae,{variant:"h4",children:["Tổng tiền : ",e.jsxs("strong",{style:{color:"red"},children:[" ",parseFloat(r?o.tongTienBanDau:0).toLocaleString()||"0"," "]})," ","VNĐ"]})})]}),e.jsxs(me,{open:I,onClose:Y,maxWidth:"xl",fullWidth:!0,children:[e.jsxs(xe,{sx:{display:"flex",justifyContent:"space-between",alignItems:"center"},children:[e.jsx(Ae,{variant:"h3",children:"Danh sách sản phẩm"}),e.jsx(w,{onClick:Y,children:"Đóng"})]}),e.jsx(ta,{onLoading:()=>{he()},selectedRowsInBill:h})]}),e.jsxs(me,{open:D,onClose:q,PaperProps:{style:{width:"700px"}},children:[e.jsx(xe,{children:e.jsxs(st,{display:"flex",alignItems:"center",justifyContent:"space-between",children:[e.jsx("span",{style:{fontSize:"1.2rem",fontWeight:"bold"},children:"Danh sách serial"}),e.jsx(pe,{variant:"outlined",size:"small",label:"Tìm kiếm",style:{marginRight:"16px"},onChange:oe})]})}),e.jsxs(_e,{children:[e.jsx(J,{component:L,children:e.jsxs(Z,{children:[e.jsx(ee,{children:e.jsxs(b,{children:[e.jsx(i,{children:"Chọn"}),e.jsx(i,{children:"Mã"}),e.jsx(i,{children:"Trạng thái"})]})}),e.jsx(te,{children:je.map(s=>e.jsxs(b,{children:[e.jsx(nt,{checked:h.includes(s.id),onChange:()=>ce(s.id),disabled:s.trangThai===1&&!h.includes(s.id)&&!Se.includes(s.id)}),e.jsx(i,{children:s.ma}),e.jsx(i,{children:e.jsx(at,{label:s.trangThai==0?"Chưa bán":s.trangThai==1?"Đã bán":"Hủy",style:{backgroundColor:ct(s.trangThai),color:"#fff"},size:"small"})})]},s.id))})]})}),e.jsx(it,{sx:{marginTop:"10px",textAlign:"center"},count:Math.ceil(be/z),page:W,onChange:(s,d)=>le(d)})]}),e.jsxs(Oe,{children:[e.jsx(w,{onClick:q,children:"Hủy"}),e.jsx(w,{onClick:()=>{ie()},variant:"contained",color:"primary",children:"Xác nhận"})]})]}),e.jsx(Re,{open:u,autoHideDuration:6e3,onClose:V,anchorOrigin:{vertical:"top",horizontal:"right"},children:e.jsx(Ee,{onClose:V,severity:T,sx:{width:"100%"},children:v})})]})}const ya=async l=>{try{return await Ne(`hoa-don-httt/all/bill/${l}`)}catch(r){throw console.error("Error fetching bill filter:",r),r}},Ta=async(l,r)=>{try{return await Ie(`hoa-don-httt/create/bill/${l}`,r)}catch(c){throw console.error("Error creating addPaymentHistory :",c),c}},ka=async l=>{console.log(l);try{return await Vt(`hoa-don-httt/delete/${l}`)}catch(r){throw console.log("Error Delete :",r),r}};function wa(l){const{id:r}=Pe(),{showDiaLogCoupon:c,bill:o,handleCloseDiaLogCoupon:j,onLoading:I}=l,[_,D]=a.useState(""),[H,v]=a.useState("success"),[O,T]=a.useState(!1),[C,u]=a.useState([]),A=async h=>{try{(await Xt(h,r)).status_code===201&&(D("Thêm phiếu giảm giá thành công"),v("success"),T(!0),I(),j())}catch{response.status_code===201&&(D("Thêm phiếu giảm giá thất bại"),v("error"),T(!0))}};a.useEffect(()=>{c&&M()},[c]);const M=async()=>{try{const h=await Kt(r);h.status_code===200&&u(h.data)}catch{D("Api phiếu giảm giá lỗi"),v("error"),T(!0)}},R=()=>{T(!1)};return e.jsxs(e.Fragment,{children:[e.jsxs(me,{open:c,onClose:j,maxWidth:"md",fullWidth:!0,children:[e.jsx(xe,{children:"Danh sách khách hàng"}),e.jsx(_e,{children:e.jsx(J,{component:L,style:{maxHeight:"500px"},children:e.jsxs(Z,{stickyHeader:!0,children:[e.jsx(ee,{children:e.jsxs(b,{children:[e.jsx(i,{}),e.jsx(i,{children:"Mã phiếu"}),e.jsx(i,{children:"Giá trị "}),e.jsx(i,{children:"Đơn từ "}),e.jsx(i,{children:"Giá trị đối đa "}),e.jsx(i,{children:"Số lượng"}),e.jsx(i,{children:"Loại phiếu"}),e.jsx(i,{children:"Hành động"})]})}),e.jsx(te,{style:{maxHeight:"300px",overflowY:"auto"},children:C.map(h=>e.jsxs(b,{children:[e.jsx(i,{}),e.jsxs(i,{children:[h.ma," "]}),e.jsxs(i,{children:[parseInt(h.giaTriGiamGia||0).toLocaleString()||"0"," ",h.loaiGiamGia===1?"%":"VNĐ"]}),e.jsx(i,{children:parseFloat(h.giaTriDonToiThieu||0).toLocaleString()||"0"}),e.jsxs(i,{children:[parseFloat(h.giamToiDa||0).toLocaleString()||"0"," VNĐ "]}),e.jsx(i,{children:h.soLuong}),e.jsx(i,{children:h.phamViApDung==1?"Công khai":"Cá nhân"}),e.jsx(i,{children:e.jsx(K,{title:`Chọn phiếu giảm giá: ${h.ma}`,placement:"top",children:e.jsx(ge,{onClick:()=>{A(h.id)},variant:"contained",color:"primary",disabled:o.idPhieuGiamGia===h.id,children:e.jsx(Qt,{})})})})]},h.id))})]})})}),e.jsx(Oe,{children:e.jsx(w,{onClick:j,color:"primary",children:"Đóng"})})]}),e.jsx(Re,{open:O,autoHideDuration:6e3,onClose:R,anchorOrigin:{vertical:"top",horizontal:"right"},children:e.jsx(Ee,{onClose:R,severity:H,sx:{width:"100%"},children:_})})]})}export{wa as C,Ca as S,Ta as a,Sa as b,ja as c,ka as d,fa as e,xa as f,ya as g,ba as h};

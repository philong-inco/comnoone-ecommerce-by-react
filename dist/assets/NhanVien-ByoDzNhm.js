import{r as l,b as ce,j as e,M as he,B as I,G as p,F as y,f as de,n as A,t as ge,o as xe,R as ue,i as pe,k as me,p as R,d as fe,A as be,m as w,T as je,e as S}from"./index-BIssY3ES.js";import{u as T,w as ye}from"./xlsx-ChUIJHMt.js";import{g as u,p as G}from"./request-CBzxMAFn.js";import{d as we}from"./Add-CSRCs860.js";import{d as Se,I as Te}from"./InsertDriveFile-xTonhvQx.js";import{M as C}from"./MenuItem-DXPtbgVP.js";import{T as Ce,a as ke,b as Ee,c as $,d as Ne}from"./TableRow-DRER82D7.js";import{T as t}from"./TableCell-BTwc7VYq.js";import{S as Ve}from"./Switch-CEN9aA3z.js";import{T as ve}from"./TablePagination-FwlX19aN.js";import{D as ze,a as De,b as _e,c as Pe}from"./DialogTitle-CNaKTOiI.js";import"./KeyboardArrowRight-DCS3bnxJ.js";import"./LastPage-DAj5RLva.js";const F=async s=>{try{return await u(`/nhan_vien/all?pageNo=${s}`)}catch(r){throw console.error("Error fetching Employees:",r),r}},Ie=async()=>{try{return await u("/nhan_vien/danhsachnhanvien")}catch(s){throw console.error("Error fetching Employees:",s),s}},W=async(s,r,c)=>{try{return await u(`/nhan_vien/search?pageNo=${s}&search=${c}`)}catch(o){throw console.error("Error fetching Employees by keyword:",o),o}},B=async(s,r,c)=>{try{debugger;return await u(`/nhan_vien/searchtrangthai?pageNo=${s}&trangThai=${c}`)}catch(o){throw console.error("Error fetching Employees by status:",o),o}},L=async(s,r,c)=>{try{debugger;return await u(`/nhan_vien/searchgioitinh?pageNo=${s}&gioiTinh=${c}`)}catch(o){throw console.error("Error fetching Employees by sex:",o),o}},Ae=async s=>{try{return await G(`/nhan_vien/remove/${s}`)}catch(r){throw console.error("Error deleting Employee:",r),r}},Re=async s=>{try{return await G(`/nhan_vien/rollBackStatus/${s}`)}catch(r){throw console.error("Error rolling back Employee status:",r),r}},Qe=()=>{const[s,r]=l.useState(1);l.useState(0);const[c,o]=l.useState(""),[d,m]=l.useState(""),[K,f]=l.useState(!1),[k,E]=l.useState(null),[b,N]=l.useState(null),[V,M]=l.useState([]),[$e,Y]=l.useState([]),[g,j]=l.useState(""),H=[{id:"",name:"Tất Cả"},{id:"0",name:"Đã Nghỉ Việc"},{id:"1",name:"Đang Làm Việc"}],v=ce(),[n,z]=l.useState({page:0,size:5}),[O,X]=l.useState(0),D=async()=>{try{debugger;let a;c?a=await W(n.page,n.size,c):d?a=await B(n.page,n.size,d):g!==""?a=await L(n.page,n.size,g):a=await F(n.page,n.size),M(a.content),X(a.totalElements)}catch(a){console.log(a)}},q=(a,i)=>{z(x=>({...x,page:i}))},J=a=>{z({...n,size:parseInt(a.target.value,10),page:0})},Q=async()=>{let a;try{a=await Ie(),Y(a)}catch(i){console.log(i)}};l.useEffect(()=>{D()},[n.page,n.size,c,d,g]),l.useEffect(()=>{Q()},[]);const U=a=>{switch(a){case 0:return e.jsx(S,{label:"Đã Nghỉ Việc",color:"default",style:{backgroundColor:"#f44336",color:"#fff"}});case 1:return e.jsx(S,{label:"Đang Làm Việc",color:"success",style:{backgroundColor:"#4caf50",color:"#fff"}});default:return e.jsx(S,{label:"Không xác định",color:"warning",style:{backgroundColor:"#ff9800",color:"#fff"}})}},Z=a=>{o(a.target.value),r(1),m(""),j("")},ee=a=>{debugger;m(a.target.value),r(1),o(""),j("")},ae=a=>{const i=a.target.value;j(i),r(1),o(""),m("")},ne=async()=>{f(!1);try{b===0?await Ae(k):await Re(k),D()}catch(a){console.error("Error updating employee status:",a)}},_=()=>{f(!1),E(null),N(null)},P=a=>{const i={year:"numeric",month:"2-digit",day:"2-digit"};return new Date(a).toLocaleDateString("vi-VN",i)},te=(a,i)=>{E(a),N(i===1?0:1),f(!0)},re=()=>{v("/nhanvien/configuration")},se=a=>{v(`/nhanvien/configuration/${a}`)},oe=new Date().getFullYear();Array.from(new Array(101),(a,i)=>oe-i);const ie=async()=>{try{let a;c?a=await W(n.page,n.size,c):d?a=await B(n.page,n.size,d):g!==""?a=await L(n.page,n.size,g):a=await F(n.page,n.size);const i=T.json_to_sheet(a.content.map((h,le)=>({STT:le+1+(n.page-1)*n.size,"Hình Ảnh":h.hinhAnh,Mã:h.ma,Tên:h.ten,"Ngày Sinh":P(h.ngaySinh),"Số Điện Thoại":h.sdt,Email:h.email,"Địa Chỉ":h.diaChi,"Trạng Thái":h.trangThai===1?"Đang Làm Việc":"Đã Nghỉ Việc"}))),x=T.book_new();T.book_append_sheet(x,i,"Danh Sách Nhân Viên"),ye(x,"danh_sach_nhan_vien.xlsx")}catch(a){console.log("Lỗi khi xuất file Excel:",a)}};return e.jsxs(he,{style:{textAlign:"center"},children:[e.jsxs(I,{sx:{backgroundColor:"white",boxShadow:"0 4px 8px rgba(0.3, 0.3, 0.2, 0.3)",borderRadius:"8px",p:3,mb:3,width:"100%"},children:[e.jsxs(p,{container:!0,spacing:3,children:[e.jsxs(p,{item:!0,xs:12,sm:6,md:4,children:[e.jsx(y,{component:"legend",sx:{fontWeight:"bold",mb:1},children:"Tìm Kiếm"}),e.jsx(de,{label:"Tìm kiếm theo mã, tên, email, số điện thoại",value:c,onChange:Z,variant:"outlined",fullWidth:!0})]}),e.jsxs(p,{item:!0,xs:12,sm:6,md:4,children:[e.jsx(y,{component:"legend",sx:{fontWeight:"bold",mb:1},children:"Giới Tính"}),e.jsxs(A,{fullWidth:!0,children:[e.jsx(ge,{id:"gender-select-label",children:"-- Chọn giới tính --"}),e.jsxs(xe,{labelId:"gender-select-label",id:"gender-select",value:g,onChange:ae,children:[e.jsx(C,{value:"",children:e.jsx("em",{children:"-- Chọn giới tính --"})}),e.jsx(C,{value:1,children:"Nam"}),e.jsx(C,{value:0,children:"Nữ"})]})]})]}),e.jsxs(p,{item:!0,xs:12,sm:12,md:4,children:[e.jsx(y,{component:"legend",sx:{fontWeight:"bold",mb:1},children:"Trạng Thái"}),e.jsx(A,{component:"fieldset",fullWidth:!0,children:e.jsx(ue,{row:!0,value:d,onChange:ee,children:H.map(a=>e.jsx(pe,{value:a.id,control:e.jsx(me,{}),label:a.name},a.id))})})]})]}),e.jsxs(I,{sx:{position:"fixed",top:350,right:16,display:"flex",flexDirection:"column",alignItems:"center",zIndex:1300},children:[e.jsx(R,{color:"primary","aria-label":"add",title:"Thêm Nhân Viên",sx:{height:"60px",width:"60px",backgroundColor:"#007bff",color:"#fff",boxShadow:"0px 8px 15px rgba(0, 123, 255, 0.3)",transition:"all 0.3s ease",marginBottom:"10px","&:hover":{backgroundColor:"#0056b3",boxShadow:"0px 15px 20px rgba(0, 86, 179, 0.4)",transform:"translateY(-3px)"},"&:active":{backgroundColor:"#004080",boxShadow:"0px 5px 10px rgba(0, 64, 128, 0.2)",transform:"translateY(1px)"}},onClick:re,children:e.jsx(we,{sx:{fontSize:"30px"}})}),e.jsx(R,{color:"primary","aria-label":"export",title:"Xuất danh sách nhân viên",sx:{height:"60px",width:"60px",backgroundColor:"#28a745",color:"#fff",boxShadow:"0px 8px 15px rgba(40, 167, 69, 0.3)",transition:"all 0.3s ease","&:hover":{backgroundColor:"#218838",boxShadow:"0px 15px 20px rgba(33, 136, 56, 0.4)",transform:"translateY(-3px)"},"&:active":{backgroundColor:"#1e7e34",boxShadow:"0px 5px 10px rgba(30, 126, 52, 0.2)",transform:"translateY(1px)"}},onClick:ie,children:e.jsx(Se,{sx:{fontSize:"30px"}})})]})]}),e.jsx(Ce,{component:fe,children:e.jsxs(ke,{children:[e.jsx(Ee,{children:e.jsxs($,{children:[e.jsx(t,{children:"STT"}),e.jsx(t,{children:"Hình Ảnh"}),e.jsx(t,{children:"Mã"}),e.jsx(t,{children:"Tên"}),e.jsx(t,{children:"Ngày Sinh"}),e.jsx(t,{children:"Số Điện Thoại"}),e.jsx(t,{children:"Email"}),e.jsx(t,{children:"Địa Chỉ"}),e.jsx(t,{children:"Trạng Thái"}),e.jsx(t,{children:"Hành Động"})]})}),e.jsx(Ne,{children:V.length>0&&V.map((a,i)=>{const x=P(a.ngaySinh);return e.jsxs($,{children:[e.jsx(t,{children:i+1+(s-1)*5}),e.jsx(t,{children:e.jsx(be,{alt:a.ten,src:a.hinhAnh,sx:{width:100,height:100}})}),e.jsx(t,{children:a.ma}),e.jsx(t,{children:a.ten}),e.jsx(t,{children:x}),e.jsx(t,{children:a.sdt}),e.jsx(t,{children:a.email}),e.jsx(t,{children:a.diaChi}),e.jsx(t,{children:U(a.trangThai)}),e.jsxs(t,{children:[e.jsx(w,{className:"btn btn-link",title:"Sửa Nhân Viên",children:e.jsx(Te,{stroke:2,onClick:()=>se(a.id)})}),e.jsx(Ve,{checked:a.trangThai===1,onChange:()=>te(a.id,a.trangThai),color:"primary",title:"Trạng thái nhân viên"})]})]},a.id)})})]})}),e.jsx(ve,{rowsPerPageOptions:[5],component:"div",count:O,rowsPerPage:n.size,page:n.page,onPageChange:q,onRowsPerPageChange:J}),e.jsxs(ze,{open:K,onClose:_,"aria-labelledby":"alert-dialog-title","aria-describedby":"alert-dialog-description",children:[e.jsx(De,{id:"alert-dialog-title",children:"Xác nhận thay đổi trạng thái"}),e.jsx(_e,{children:e.jsxs(je,{children:["Bạn có chắc chắn muốn ",b===0?"xóa":"khôi phục"," nhân viên này không?"]})}),e.jsxs(Pe,{children:[e.jsx(w,{onClick:_,color:"primary",children:"Hủy"}),e.jsx(w,{onClick:ne,color:"secondary",autoFocus:!0,children:b===0?"Xóa":"Khôi phục"})]})]})]})};export{Qe as default};

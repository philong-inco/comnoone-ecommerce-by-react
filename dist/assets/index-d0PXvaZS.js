import{h as _,j as e,a4 as I,G as g,N as C,Z as k,ac as W,J as q,a5 as X,a6 as J,a7 as S,a8 as v,B as A,V as Q,a2 as L,a as U,I as Y,r as l}from"./index-COCf9D-9.js";import{g as Z,c as ee}from"./billService-BKD01eM1.js";import{A as ae}from"./Add-DbXBUQeH.js";import{g as te,a as ne}from"./billStatus-B9UV_zRI.js";import{d as se}from"./Visibility-DRIH_QO8.js";import{T as le,a as re}from"./Tabs-DiJb2MiR.js";import{T as oe,a as ie,b as ce,c as P,d as de}from"./TableRow-BjFi84E7.js";import{T as F}from"./TableCell-DFzCksj9.js";import{P as he}from"./Pagination-p0ct8pHs.js";import"./request-BSxo6Ply.js";import"./KeyboardArrowRight-DZPhPuW4.js";import"./LastPage-DEWP3WKD.js";const me=_(e.jsx("path",{d:"M19 9h-4V3H9v6H5l7 7zM5 18v2h14v-2z"}),"FileDownload"),ge=_(e.jsx("path",{d:"M15.5 14h-.79l-.28-.27C15.41 12.59 16 11.11 16 9.5 16 5.91 13.09 3 9.5 3S3 5.91 3 9.5 5.91 16 9.5 16c1.61 0 3.09-.59 4.23-1.57l.27.28v.79l5 4.99L20.49 19zm-6 0C7.01 14 5 11.99 5 9.5S7.01 5 9.5 5 14 7.01 14 9.5 11.99 14 9.5 14"}),"Search");function xe(p){const{handleSearch:h,handleCreateBill:j,onDateChange:y,fromDate:o,toDate:x,handleBillTypeChange:i}=p,T=I(),c=d=>{const{name:m,value:u}=d.target;y(m,u)};return e.jsxs("div",{style:{backgroundColor:"white",padding:"10px",borderRadius:"10px"},children:[e.jsxs(g,{container:!0,spacing:2,className:"mb-10",children:[e.jsx(g,{item:!0,xs:12,sm:6,children:e.jsx(C,{fullWidth:!0,placeholder:"Tìm kiếm mã hóa đơn , sdt , email",InputProps:{startAdornment:e.jsx(ge,{style:{marginRight:"8px"}})},onChange:d=>h(d.target.value),variant:"outlined",size:"small"})}),e.jsxs(g,{item:!0,xs:12,sm:6,container:!0,justifyContent:"flex-end",children:[e.jsx(k,{variant:"outlined",color:"primary",startIcon:e.jsx(me,{}),children:"Quét mã"}),e.jsx(k,{variant:"contained",color:"primary",startIcon:e.jsx(ae,{}),onClick:()=>{T("/ban-hang")},style:{marginLeft:"10px"},children:"Tạo hóa đơn"})]})]}),e.jsx(W,{style:{margin:"10px 0"}}),e.jsxs(g,{container:!0,spacing:2,children:[e.jsx(g,{item:!0,xs:6,sm:3,children:e.jsx(C,{label:"Từ ngày",type:"date",name:"tuNgay",value:o||"",onChange:c,fullWidth:!0,InputLabelProps:{shrink:!0}})}),e.jsx(g,{item:!0,xs:6,sm:3,children:e.jsx(C,{label:"Đến ngày",name:"denNgay",type:"date",value:x||"",onChange:c,fullWidth:!0,InputLabelProps:{shrink:!0}})}),e.jsxs(g,{item:!0,xs:12,sm:6,container:!0,alignItems:"center",children:[e.jsxs(q,{component:"fieldset",children:[e.jsx(X,{component:"legend",style:{marginRight:"10px"},children:"Loại:"}),e.jsxs(J,{row:!0,defaultValue:"",onChange:i,children:[e.jsx(S,{value:"",control:e.jsx(v,{}),label:"Tất cả"}),e.jsx(S,{value:"0",control:e.jsx(v,{}),label:"Tại quầy"}),e.jsx(S,{value:"1",control:e.jsx(v,{}),label:"Online"})]})]}),e.jsx(k,{variant:"outlined",color:"primary",style:{marginLeft:"10px"},children:"Export Excel"})]})]})]})}function ue(p){const{activeKey:h,handleTabChange:j,bills:y,page:o,pageSize:x,total:i,onPageChange:T}=p,c=I(),d=[{key:"",label:"TẤT CẢ"},{key:"DON_MOI",label:"Đơn mới"},{key:"CHO_XAC_NHAN",label:"Chờ xác nhận"},{key:"CHO_GIAO",label:"Chờ giao"},{key:"DANG_GIAO",label:"Đang giao"},{key:"TRA_HANG_HOAN_TIEN",label:"Trả hàng hoàn tiền"},{key:"HOAN_THANH",label:"Hoàn thành"},{key:"HUY",label:"Hủy"}],m=t=>{console.log("Code",t),c(`/hoa-don/chi-tiet/${t}`)},u=[{title:"#",dataIndex:"key",key:"key"},{title:"Mã",dataIndex:"ma",key:"ma"},{title:"Tổng SP",dataIndex:"tongSanPham",key:"tongSanPham"},{title:"Tổng số tiền",dataIndex:"tongTien",key:"tongTien"},{title:"Tên khách hàng",dataIndex:"tenKhachHang",key:"tenKhachHang",render:t=>t??"Khách lẻ"},{title:"SDT",dataIndex:"sdt",key:"sdt"},{title:"Email",dataIndex:"email",key:"email"},{title:"Ngày tạo",dataIndex:"ngayTao",key:"ngayTao"},{title:"Loại hóa đơn",dataIndex:"loaiHoaDon",key:"loaiHoaDon",render:t=>e.jsx(L,{label:t==0?"Tại quầy":"Online",color:t==0?"primary":"success",size:"small"})},{title:"Trạng thái",dataIndex:"trangThai",key:"trangThai",render:t=>e.jsx(L,{label:te(t),style:{backgroundColor:ne(t),color:"#fff"},size:"small"})},{title:"Hành động",key:"action",render:(t,n)=>e.jsx(e.Fragment,{children:e.jsx(U,{title:"Xem chi tiết",children:e.jsx(Y,{onClick:()=>m(n.ma),children:e.jsx(se,{})})})})}];return e.jsxs(A,{sx:{backgroundColor:"white",marginTop:"10px",borderRadius:"10px",padding:"10px"},children:[e.jsx(le,{value:h,onChange:(t,n)=>j(n),variant:"scrollable",scrollButtons:"auto",allowScrollButtonsMobile:!0,children:d.map(t=>e.jsx(re,{label:t.label,value:t.key,sx:{marginLeft:"10px"}},t.key))}),d.map(t=>e.jsx(A,{hidden:h!==t.key,sx:{marginTop:"20px"},children:h===t.key&&e.jsxs(e.Fragment,{children:[e.jsx(oe,{component:Q,children:e.jsxs(ie,{"aria-label":"simple table",children:[e.jsx(ce,{children:e.jsx(P,{children:u.map(n=>e.jsx(F,{children:n.title},n.key))})}),e.jsx(de,{children:y.map(n=>e.jsx(P,{children:u.map(r=>e.jsx(F,{children:r.render?r.render(n[r.dataIndex],n):n[r.dataIndex]},r.key))},n.id))})]})}),e.jsx(he,{sx:{marginTop:"10px",textAlign:"center"},count:Math.ceil(i/x),page:o,onChange:(n,r)=>T(r)})]})},t.key))]})}function He(){I();const[p,h]=l.useState(""),[j,y]=l.useState([]),[o,x]=l.useState(null),[i,T]=l.useState(null),[c,d]=l.useState(""),[m,u]=l.useState(""),[t,n]=l.useState(""),[r,f]=l.useState(1),[N,O]=l.useState(5),[w,z]=l.useState(0),[E,H]=l.useState(!1),D=(a,s=!0)=>{if(!a)return null;const b=new Date(a);return isNaN(b.getTime())?(console.error("Lỗi : ",a),null):(s?b.setHours(0,0,0,0):b.setHours(23,59,59,999),b.getTime())},B=async()=>{if(E)return;H(!0);let a=` ( ma ~~ '${c.trim()}' or sdt ~~ '${c.trim()}' or email ~~ '${c.trim()}') `;m&&(a+=` and loaiHoaDon:${m}`),t&&(a+=` and trangThai:'${t}'`),o&&i&&(a+=` and ngayTao >: '${D(o,!0)}' and ngayTao <:'${D(i,!1)}'   `);try{const s=await Z(r-1,N,a);s.status_code===200&&(y(s.data.result),f(s.data.meta.page+1),O(s.data.meta.pageSize),z(s.data.meta.total))}catch(s){console.error("Lỗi : ",s)}finally{H(!1)}},R=a=>{console.log(`PAGE ${a}`),f(a)},$=a=>{d(a),f(1)},G=a=>{u(a.target.value)},M=(a,s)=>{a==="tuNgay"&&s!==null?x(s):a==="denNgay"&&s!==null&&T(s),console.table(o,i)},K=async()=>{try{const a=await ee();a.status_code===201&&(alert("Thông báo Oke : "+a.data.ma),B())}catch(a){alert("Thông báo Error : "+a.response.data.error)}};l.useEffect(()=>{B()},[o,i,c,m,t,r]);const V=a=>{f(1),n(a),h(a)};return e.jsxs(e.Fragment,{children:[e.jsx(xe,{handleSearch:$,handleCreateBill:K,onDateChange:M,fromDate:o,toDate:i,handleBillTypeChange:G}),e.jsx(ue,{activeKey:p,handleTabChange:V,bills:j,page:r,pageSize:N,total:w,onPageChange:R})]})}export{He as default};
